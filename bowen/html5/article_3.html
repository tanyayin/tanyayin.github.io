<!DOCTYPE html>
<html lang="zh">
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
   <!-- <link href='https://fonts.googleapis.com/css?family=Architects+Daughter' rel='stylesheet' type='text/css'>-->
    <link rel="stylesheet" type="text/css" href="../../stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="../../stylesheets/pygment_trac.css" media="screen">
    <link rel="stylesheet" type="text/css" href="../../stylesheets/print.css" media="print">
    <link rel="stylesheet" href="http://cdn.bootcss.com/bootstrap/3.2.0/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="../../style/mycss.css" media="screen">
    <script src="http://v3.bootcss.com/assets/js/ie-emulation-modes-warning.js"></script>
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <title>HTML 5 canvas学习（一）</title>
  </head>
  <body>
    <header class="h_box">
      <!--nav-->
       <nav class="navbar navbar-inverse y_nav" role="navigation">
        <div class="container-fluid">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand">TanyaYin</a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav ">
           <li><a href="index.html">首页</a></li>
            <li><a href="aboutme">关于我</a></li>
            <li><a data-toggle="modal" data-target="#myModal">我的博文</a></li>
          </ul>
      </div>
      </div>
    </nav>
      <!--nav-end-->
      <!---->
      <div class="inner y_inner">
        <h1>TanyaYin的博客</h1>
        <h2>这里是Tanya的个人Blog，欢迎访问！</h2>
        <a href="https://github.com/tanyayin" class="button h_flm"><small>Follow me on</small> GitHub</a>
      </div>
    </header>
<div class='container bs-docs-container art'>
 <div class="row">
   <aside class='art_aside col-md-3'>
    <div class="bs-docs-sidebar hidden-print hidden-xs hidden-sm" role="complementary"> 
    <ul class="nav" id="y_nav" aria-multiselectable="true">
     <li class="panel">
        <a href="#demo1" data-toggle="collapse"  data-parent="#y_nav" aria-expanded="true" aria-controls="demo1" class="y_aa">HTML5</a>
        <ul class="nav collapse in" id="demo1">
         <li><a href="">你好</a></li>
       </ul>
   </li>
     <li class="panel">
        <a href="#demo2" data-toggle="collapse"  data-parent="#y_nav" aria-expanded="false" aria-controls="demo2" class="y_aa">HTML5</a>
        <ul class="nav collapse" id="demo2">
         <li><a href="">HTML5</a></li>
       </ul>
   </li>
     <li class="panel">
        <a href="#demo3" data-toggle="collapse"  data-parent="#y_nav" aria-expanded="false" aria-controls="demo3" class="y_aa">CSS3</a>
        <ul class="nav collapse" id="demo3">
         <li><a href="">CSS3</a></li>
       </ul>
   </li>
     <li class="panel">
        <a href="#demo4" data-toggle="collapse"  data-parent="#y_nav" aria-expanded="false" aria-controls="demo4" class="y_aa">Btootstrap</a>
        <ul class="nav collapse" id="demo4">
         <li><a href="">HTML5</a></li>
       </ul>
   </li>
     <li class="panel">
        <a href="#demo5" data-toggle="collapse"  data-parent="#y_nav" aria-expanded="false" aria-controls="demo5" class="y_aa">JS/JQ</a>
        <ul class="nav collapse" id="demo5">
         <li><a href="">HTML5</a></li>
       </ul>
   </li>
     <li class="panel">
        <a href="#demo6" data-toggle="collapse"  data-parent="#y_nav" aria-expanded="false" aria-controls="demo6" class="y_aa">LESS</a>
        <ul class="nav collapse" id="demo6">
         <li><a href="">HTML5</a></li>
       </ul>
   </li>
     <li class="panel">
        <a href="#demo7" data-toggle="collapse"  data-parent="#y_nav" aria-expanded="false" aria-controls="demo7" class="y_aa">SASS</a>
        <ul class="nav collapse" id="demo7">
         <li><a href="">HTML5</a></li>
       </ul>
   </li>
     <li class="panel">
        <a href="#demo8" data-toggle="collapse"  data-parent="#y_nav" aria-expanded="false" aria-controls="demo8" class="y_aa">STYLES</a>
        <ul class="nav collapse" id="demo8">
         <li><a href="">HTML5</a></li>
       </ul>
   </li>
     <li class="panel">
        <a href="#demo9" data-toggle="collapse"  data-parent="#y_nav" aria-expanded="false" aria-controls="demo9" class="y_aa">GIT</a>
        <ul class="nav collapse" id="demo9">
         <li><a href="">HTML5</a></li>
       </ul>
   </li>
     <li class="panel">
        <a href="#demo10" data-toggle="collapse"  data-parent="#y_nav" aria-expanded="false" aria-controls="demo10" class="y_aa">PHP/thinkphp</a>
        <ul class="nav collapse" id="demo10">
         <li><a href=""></a></li>
       </ul>
   </li>
    <li class="panel">
        <a href="#demo11" data-toggle="collapse"  data-parent="#y_nav" aria-expanded="false" aria-controls="demo11" class="y_aa">CMS</a>
        <ul class="nav collapse" id="demo11">
         <li><a href="">HTML5</a></li>
       </ul>
   </li>    
   <li class="panel">
        <a href="#demo12" data-toggle="collapse"  data-parent="#y_nav" aria-expanded="false" aria-controls="demo12" class="y_aa">TOOLS</a>
        <ul class="nav collapse" id="demo12">
         <li><a href="">HTML5</a></li>
       </ul>
   </li>

   

   
   
   
   
   
   
</ul>
</div>


   </aside>
    <article class="col-md-9 artfl_rit">
     <header>
       <h1>HTML 5 canvas学习（一）</h1>
     </header>
     <aside class="aside_ts">
<p><strong>前言</strong></p>
<hr />
<p>&nbsp;&nbsp;&nbsp;&nbsp; &lt;canvas&gt;&lt;/canvas&gt;是html5出现的新标签，像所有的dom对象一样它有自己本身的属性、方法和事件，其中就有绘图的方法，js能够调用它来进行绘图&nbsp;，最近在研读《html5与css3权威指南》下面对其中最好玩的canvas的学习做下读书笔记与实验。</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp; 温馨提示：以下所有实验请使用最新版的opera</p>
</aside>

     <div class="art_info">
<p><strong>基本知识</strong></p>
<hr />
<p><strong>&nbsp;</strong>&nbsp;&nbsp; context:一直觉得这个翻译成&ldquo;上下文&rdquo;真够蛋疼的，context是一个封装了很多绘图功能的对象，获取这个对象的方法是<strong>&nbsp;&nbsp;</strong></p>
<p><strong>&nbsp;&nbsp;&nbsp;</strong>&nbsp;&nbsp;&nbsp;&nbsp; var context&nbsp;=canvas.getContext("2d");</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;也许这个2d勾起了大家的无限遐想，但是很遗憾的告诉你html5还只是个少女，不提供3d服务。</p>
<p><strong>&nbsp;&nbsp;&nbsp;</strong></p>
<p>&nbsp;&nbsp;&nbsp; canvas元素绘制图像的时候有两种方法，分别是</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; context.fill()//填充</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; context.stroke()//绘制边框</p>
<p>&nbsp;&nbsp;&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp; style:在进行图形绘制前，要设置好绘图的样式</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; context.fillStyle//填充的样式</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; context.strokeStyle//边框样式</p>
<p>&nbsp;&nbsp;&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp; context.lineWidth//图形边框宽度</p>
<p>&nbsp;&nbsp;&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp; 颜色的表示方式:</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 直接用颜色名称:"red" "green" "blue"</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 十六进制颜色值: "#EEEEFF"</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rgb(1-255,1-255,1-255)</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rgba(1-255,1-255,1-255,透明度)</p>
<p>&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp; &nbsp;和GDI是如此的相像，所以用过GDI的朋友应该很快就能上手</p>

<p>&nbsp;</p>
<p><strong>绘制矩形&nbsp; context.fillRect(x,y,width,height)&nbsp; strokeRect(x,y,width,height)</strong></p>
<hr />
<p><em>&nbsp;&nbsp;&nbsp;&nbsp; x:矩形起点横坐标（坐标原点为canvas的左上角，当然确切的来说是原始原点，后面写到变形的时候你就懂了，现在暂时不用关系）</em></p>
<p><em>&nbsp;&nbsp;&nbsp;&nbsp; y:矩形起点纵坐标</em></p>
<p><em>&nbsp;&nbsp;&nbsp;&nbsp; width:矩形长度</em></p>
<p><em>&nbsp;&nbsp;&nbsp;&nbsp; height:矩形高度</em></p>
<div><b>View Code </b>
<div>
<pre><span style="color: #008080;"> 1</span>  <span style="color: #0000ff;">function</span><span style="color: #000000;"> draw21(id) {
</span><span style="color: #008080;"> 2</span>             <span style="color: #0000ff;">var</span> canvas =<span style="color: #000000;"> document.getElementById(id)
</span><span style="color: #008080;"> 3</span>             <span style="color: #0000ff;">if</span> (canvas == <span style="color: #0000ff;">null</span><span style="color: #000000;">)
</span><span style="color: #008080;"> 4</span>                 <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">false</span><span style="color: #000000;">;
</span><span style="color: #008080;"> 5</span>             <span style="color: #0000ff;">var</span> context = canvas.getContext("2d"<span style="color: #000000;">);
</span><span style="color: #008080;"> 6</span>             <span style="color: #008000;">//</span><span style="color: #008000;">实践表明在不设施fillStyle下的默认fillStyle=black</span>
<span style="color: #008080;"> 7</span>             context.fillRect(0, 0, 100, 100<span style="color: #000000;">);
</span><span style="color: #008080;"> 8</span>             <span style="color: #008000;">//</span><span style="color: #008000;">实践表明在不设施strokeStyle下的默认strokeStyle=black</span>
<span style="color: #008080;"> 9</span>             context.strokeRect(120, 0, 100, 100<span style="color: #000000;">);
</span><span style="color: #008080;">10</span> 
<span style="color: #008080;">11</span>             <span style="color: #008000;">//</span><span style="color: #008000;">设置纯色</span>
<span style="color: #008080;">12</span>             context.fillStyle = "red"<span style="color: #000000;">;
</span><span style="color: #008080;">13</span>             context.strokeStyle = "blue"<span style="color: #000000;">;
</span><span style="color: #008080;">14</span>             context.fillRect(0, 120, 100, 100<span style="color: #000000;">);
</span><span style="color: #008080;">15</span>             context.strokeRect(120, 120, 100, 100<span style="color: #000000;">);
</span><span style="color: #008080;">16</span> 
<span style="color: #008080;">17</span>             <span style="color: #008000;">//</span><span style="color: #008000;">设置透明度实践证明透明度值&gt;0,&lt;1值越低，越透明，值&gt;=1时为纯色，值&lt;=0时为完全透明</span>
<span style="color: #008080;">18</span>             context.fillStyle = "rgba(255,0,0,0.2)"<span style="color: #000000;">;
</span><span style="color: #008080;">19</span>             context.strokeStyle = "rgba(255,0,0,0.2)"<span style="color: #000000;">;
</span><span style="color: #008080;">20</span>             context.fillRect(240,0 , 100, 100<span style="color: #000000;">);
</span><span style="color: #008080;">21</span>             context.strokeRect(240, 120, 100, 100<span style="color: #000000;">);
</span><span style="color: #008080;">22</span>         }</pre>
</div>
</div>
<div class="arc_pic"><img src="../../images/bw3/2012073016285328.jpg" alt="" /></div>
<p>&nbsp;</p>
<p id="2"><strong>清除矩形区域 context.clearRect(x,y,width,height)</strong></p>
<hr />
<p><em>&nbsp;&nbsp;&nbsp;&nbsp; x:清除矩形起点横坐标</em></p>
<p><em>&nbsp;&nbsp;&nbsp;&nbsp; y:清除矩形起点纵坐标</em></p>
<p><em>&nbsp;&nbsp;&nbsp;&nbsp; width:清除矩形长度</em></p>
<p><em>&nbsp;&nbsp;&nbsp;&nbsp; height:清除矩形高度</em></p>
<div><b>View Code </b>
<div>
<pre><span style="color: #008080;"> 1</span>       <span style="color: #0000ff;">function</span><span style="color: #000000;"> draw22(id) {
</span><span style="color: #008080;"> 2</span>             <span style="color: #0000ff;">var</span> canvas =<span style="color: #000000;"> document.getElementById(id)
</span><span style="color: #008080;"> 3</span>             <span style="color: #0000ff;">if</span> (canvas == <span style="color: #0000ff;">null</span><span style="color: #000000;">)
</span><span style="color: #008080;"> 4</span>                 <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">false</span><span style="color: #000000;">;
</span><span style="color: #008080;"> 5</span>             <span style="color: #0000ff;">var</span> context = canvas.getContext("2d"<span style="color: #000000;">);
</span><span style="color: #008080;"> 6</span>             <span style="color: #008000;">//</span><span style="color: #008000;">实践表明在不设施fillStyle下的默认fillStyle=black</span>
<span style="color: #008080;"> 7</span>             context.fillRect(0, 0, 100, 100<span style="color: #000000;">);
</span><span style="color: #008080;"> 8</span>             <span style="color: #008000;">//</span><span style="color: #008000;">实践表明在不设施strokeStyle下的默认strokeStyle=black</span>
<span style="color: #008080;"> 9</span>             context.strokeRect(120, 0, 100, 100<span style="color: #000000;">);
</span><span style="color: #008080;">10</span> 
<span style="color: #008080;">11</span>             <span style="color: #008000;">//</span><span style="color: #008000;">设置纯色</span>
<span style="color: #008080;">12</span>             context.fillStyle = "red"<span style="color: #000000;">;
</span><span style="color: #008080;">13</span>             context.strokeStyle = "blue"<span style="color: #000000;">;
</span><span style="color: #008080;">14</span>             context.fillRect(0, 120, 100, 100<span style="color: #000000;">);
</span><span style="color: #008080;">15</span>             context.strokeRect(120, 120, 100, 100<span style="color: #000000;">);
</span><span style="color: #008080;">16</span> 
<span style="color: #008080;">17</span>             <span style="color: #008000;">//</span><span style="color: #008000;">设置透明度实践证明透明度值&gt;0,&lt;1值越低，越透明，值&gt;=1时为纯色，值&lt;=0时为完全透明</span>
<span style="color: #008080;">18</span>             context.fillStyle = "rgba(255,0,0,0.2)"<span style="color: #000000;">;
</span><span style="color: #008080;">19</span>             context.strokeStyle = "rgba(255,0,0,0.2)"<span style="color: #000000;">;
</span><span style="color: #008080;">20</span>             context.fillRect(240, 0, 100, 100<span style="color: #000000;">);
</span><span style="color: #008080;">21</span>             context.strokeRect(240, 120, 100, 100<span style="color: #000000;">);
</span><span style="color: #008080;">22</span>             context.clearRect(50, 50, 240, 120<span style="color: #000000;">);
</span><span style="color: #008080;">23</span>         }</pre>
</div>
</div>
<div class="arc_pic"><img src="../../images/bw3/2012073016404139.jpg" alt="" /></div>

<p>&nbsp;</p>
<p id="3"><strong>&nbsp;圆弧context.arc(x, y, radius, starAngle,endAngle, anticlockwise)</strong></p>
<hr />
<p><em>&nbsp;&nbsp;&nbsp; x:圆心的x坐标</em></p>
<p><em>&nbsp;&nbsp;&nbsp; y:圆心的y坐标</em></p>
<p><em>&nbsp;&nbsp;&nbsp; straAngle:开始角度</em></p>
<p><em>&nbsp;&nbsp;&nbsp; endAngle:结束角度</em></p>
<p><em>&nbsp;&nbsp;&nbsp; anticlockwise:是否逆时针（true）为逆时针，(false)为顺时针</em></p>
<p>&nbsp;&nbsp;&nbsp; ps：经过试验证明书本上ture是顺时针，false是逆时针是错误的，而且无论是逆时针还是顺时针，角度都沿着顺时针扩大，如下图：</p>
<div class="arc_pic"><img src="../../images/bw3/2012080217203994.png" alt="" /></div>
<p>&nbsp;</p>
<div><b>View Code </b>
<div>
<pre><span style="color: #008080;"> 1</span>         <span style="color: #0000ff;">function</span><span style="color: #000000;"> draw0(id) {
</span><span style="color: #008080;"> 2</span>             <span style="color: #0000ff;">var</span> canvas =<span style="color: #000000;"> document.getElementById(id);
</span><span style="color: #008080;"> 3</span>             <span style="color: #0000ff;">if</span> (canvas == <span style="color: #0000ff;">null</span><span style="color: #000000;">) {
</span><span style="color: #008080;"> 4</span>                 <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">false</span><span style="color: #000000;">;
</span><span style="color: #008080;"> 5</span> <span style="color: #000000;">            }
</span><span style="color: #008080;"> 6</span>             <span style="color: #0000ff;">var</span> context = canvas.getContext('2d'<span style="color: #000000;">);
</span><span style="color: #008080;"> 7</span> <span style="color: #000000;">            context.beginPath();
</span><span style="color: #008080;"> 8</span>             context.arc(200, 150, 100, 0, Math.PI * 2, <span style="color: #0000ff;">true</span><span style="color: #000000;">);
</span><span style="color: #008080;"> 9</span>             <span style="color: #008000;">//</span><span style="color: #008000;">不关闭路径路径会一直保留下去，当然也可以利用这个特点做出意想不到的效果</span>
<span style="color: #008080;">10</span> <span style="color: #000000;">            context.closePath();
</span><span style="color: #008080;">11</span>             context.fillStyle = 'rgba(0,255,0,0.25)'<span style="color: #000000;">;
</span><span style="color: #008080;">12</span> <span style="color: #000000;">            context.fill();
</span><span style="color: #008080;">13</span>         }</pre>
</div>
</div>
<p>一不小心画了小日本的国旗...赶紧调下颜色和大小，绿色倒是挺合适的~</p>
<div class="arc_pic"><img src="../../images/bw3/2012080217265520.png" alt="" /></div>

<p>&nbsp;</p>
<p id="4"><strong>路径&nbsp; context.beginPath()&nbsp; &nbsp; context.closePath()</strong></p>
<hr />
<p>&nbsp;&nbsp;&nbsp; 细心的朋友会发现上面的画圆并不单单是直接用arc还用到了context的 beginPath&nbsp;&nbsp; 和closePath方法，参考书不愧是参考书，例子给得太简单了，实话说一开始我凌乱了，耐心下来做了几个实验才舒缓蛋疼的心情<strong><br /></strong></p>
<p>&nbsp;&nbsp;&nbsp; 实验代码如下，通过分别注释closePath 和beginPath看fill stoke 和fill stroke结合下画出来的两个1/4弧线达到实验效果</p>
<div><b>View Code </b>
<div>
<pre><span style="color: #008080;"> 1</span>   <span style="color: #0000ff;">function</span><span style="color: #000000;"> draw23(id) {
</span><span style="color: #008080;"> 2</span>             <span style="color: #0000ff;">var</span> canvas =<span style="color: #000000;"> document.getElementById(id);
</span><span style="color: #008080;"> 3</span>             <span style="color: #0000ff;">if</span> (canvas == <span style="color: #0000ff;">null</span><span style="color: #000000;">) {
</span><span style="color: #008080;"> 4</span>                 <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">false</span><span style="color: #000000;">;
</span><span style="color: #008080;"> 5</span> <span style="color: #000000;">            }
</span><span style="color: #008080;"> 6</span>             <span style="color: #0000ff;">var</span> context = canvas.getContext('2d'<span style="color: #000000;">);
</span><span style="color: #008080;"> 7</span>             <span style="color: #0000ff;">var</span> n = 0<span style="color: #000000;">;
</span><span style="color: #008080;"> 8</span>            
<span style="color: #008080;"> 9</span>             <span style="color: #008000;">//</span><span style="color: #008000;">左侧1/4圆弧</span>
<span style="color: #008080;">10</span> <span style="color: #000000;">            context.beginPath();
</span><span style="color: #008080;">11</span>             context.arc(100, 150, 50, 0, Math.PI/2 , false);
<span style="color: #008080;">12</span>             context.fillStyle = 'rgba(255,0,0,0.25)'<span style="color: #000000;">;
</span><span style="color: #008080;">13</span> <span style="color: #000000;">            context.fill();
</span><span style="color: #008080;">14</span>             context.strokeStyle = 'rgba(255,0,0,0.25)'
<span style="color: #008080;">15</span> <span style="color: #000000;">            context.closePath();
</span><span style="color: #008080;">16</span> <span style="color: #000000;">            context.stroke();
</span><span style="color: #008080;">17</span> 
<span style="color: #008080;">18</span>             <span style="color: #008000;">//</span><span style="color: #008000;">右侧1/4圆弧</span>
<span style="color: #008080;">19</span> <span style="color: #000000;">            context.beginPath();
</span><span style="color: #008080;">20</span>             context.arc(300, 150, 50, 0, Math.PI/2 , false);
<span style="color: #008080;">21</span>             context.fillStyle = 'rgba(255,0,0,0.25)'<span style="color: #000000;">;
</span><span style="color: #008080;">22</span> <span style="color: #000000;">            context.fill();
</span><span style="color: #008080;">23</span>             context.strokeStyle = 'rgba(255,0,0,0.25)'<span style="color: #000000;">;
</span><span style="color: #008080;">24</span> <span style="color: #000000;">            context.closePath();
</span><span style="color: #008080;">25</span> <span style="color: #000000;">            context.stroke();
</span><span style="color: #008080;">26</span>         }</pre>
</div>
</div>
<p>&nbsp;&nbsp;&nbsp; 实验结果如下：</p>
<div class="arc_pic"><img src="../../images/bw3/2012080309473833.png" alt=""/></div>
<p>&nbsp;</p>
<p>&nbsp;得出的结论有：*号为重点</p>
<p>&nbsp;&nbsp;&nbsp; 1、系统默认在绘制第一个路径的开始点为beginPath</p>
<p>&nbsp;&nbsp;&nbsp; *2、如果画完前面的路径没有重新指定beginPath，那么画第其他路径的时候会将前面最近指定的beginPath后的全部路径重新绘制</p>
<p>&nbsp;&nbsp;&nbsp; 3、每次调用context.fill（）的时候会自动把当次绘制的路径的开始点和结束点相连，接着填充封闭的部分</p>
<p>&nbsp;&nbsp;&nbsp; ps：书本的结论是&nbsp;&nbsp; 如果没有closePath那么前面的路劲会保留，实验证明正确的结论是 如果没有重新beginPath那么前面的路劲会保留</p>
<p>&nbsp;&nbsp;&nbsp; ps1：如果你真心凌乱了，那么记住每次画路径都在前后加context.beginPath()&nbsp;&nbsp; 和context.closePath()就行</p>

<p>&nbsp;</p>
<p id="5"><strong>&nbsp;绘制线段 context.moveTo(x,y)&nbsp; context.lineTo(x,y)</strong></p>
<hr />
<p><em>&nbsp;&nbsp;&nbsp; x:x坐标</em></p>
<p><em>&nbsp;&nbsp;&nbsp; y:y坐标</em></p>
<p>&nbsp;&nbsp;&nbsp; 每次画线都从moveTo的点到lineTo的点，</p>
<p>&nbsp;&nbsp;&nbsp; 如果没有moveTo那么第一次lineTo的效果和moveTo一样，</p>
<p>&nbsp;&nbsp;&nbsp; 每次lineTo后如果没有moveTo，那么下次lineTo的开始点为前一次lineTo的结束点</p>
<div><b>View Code </b>
<div>
<pre><span style="color: #008080;"> 1</span>     <span style="color: #0000ff;">function</span><span style="color: #000000;"> draw8(id) {
</span><span style="color: #008080;"> 2</span>             <span style="color: #0000ff;">var</span> canvas =<span style="color: #000000;"> document.getElementById(id);
</span><span style="color: #008080;"> 3</span>             <span style="color: #0000ff;">if</span> (canvas == <span style="color: #0000ff;">null</span><span style="color: #000000;">)
</span><span style="color: #008080;"> 4</span>                 <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">false</span><span style="color: #000000;">;
</span><span style="color: #008080;"> 5</span>             <span style="color: #0000ff;">var</span> context = canvas.getContext("2d"<span style="color: #000000;">);
</span><span style="color: #008080;"> 6</span>             <span style="color: #008000;">//</span><span style="color: #008000;">context.beginPath();</span>
<span style="color: #008080;"> 7</span>             context.strokeStyle = "rgb(250,0,0)"<span style="color: #000000;">;
</span><span style="color: #008080;"> 8</span>             context.fillStyle = "rgb(250,0,0)"
<span style="color: #008080;"> 9</span>             <span style="color: #008000;">//</span><span style="color: #008000;">实验证明第一次lineTo的时候和moveTo功能一样</span>
<span style="color: #008080;">10</span>             context.lineTo(100, 100<span style="color: #000000;">);
</span><span style="color: #008080;">11</span>             <span style="color: #008000;">//</span><span style="color: #008000;">之后的lineTo会以上次lineTo的节点为开始</span>
<span style="color: #008080;">12</span>             context.lineTo(200, 200<span style="color: #000000;">);
</span><span style="color: #008080;">13</span>             context.lineTo(200, 100<span style="color: #000000;">);
</span><span style="color: #008080;">14</span>             context.moveTo(200, 50<span style="color: #000000;">);
</span><span style="color: #008080;">15</span>             context.lineTo(100,50<span style="color: #000000;">);
</span><span style="color: #008080;">16</span> <span style="color: #000000;">            context.stroke();
</span><span style="color: #008080;">17</span>         }</pre>
</div>
</div>
<div class="arc_pic"><img src="../../images/bw3/2012080310250212.png" alt="" /></div>
<p>&nbsp;&nbsp;&nbsp; 下面给出书本的例子，一朵绿色的菊花，涉及数学，不多解析，有兴趣的自己研究</p>
<div><b>View Code </b>
<div>
<pre><span style="color: #008080;"> 1</span>   <span style="color: #0000ff;">function</span><span style="color: #000000;"> draw1(id) {
</span><span style="color: #008080;"> 2</span>             <span style="color: #0000ff;">var</span> canvas =<span style="color: #000000;"> document.getElementById(id);
</span><span style="color: #008080;"> 3</span>             <span style="color: #0000ff;">if</span> (canvas == <span style="color: #0000ff;">null</span><span style="color: #000000;">)
</span><span style="color: #008080;"> 4</span>                 <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">false</span><span style="color: #000000;">;
</span><span style="color: #008080;"> 5</span>             <span style="color: #0000ff;">var</span> context = canvas.getContext("2d"<span style="color: #000000;">);
</span><span style="color: #008080;"> 6</span>             context.fillStyle = "#EEEEFF"<span style="color: #000000;">;
</span><span style="color: #008080;"> 7</span>             context.fillRect(0, 0, 400, 300<span style="color: #000000;">);
</span><span style="color: #008080;"> 8</span>             <span style="color: #0000ff;">var</span> n = 0<span style="color: #000000;">;
</span><span style="color: #008080;"> 9</span>             <span style="color: #0000ff;">var</span> dx = 150<span style="color: #000000;">;
</span><span style="color: #008080;">10</span>             <span style="color: #0000ff;">var</span> dy = 150<span style="color: #000000;">;
</span><span style="color: #008080;">11</span>             <span style="color: #0000ff;">var</span> s = 100<span style="color: #000000;">;
</span><span style="color: #008080;">12</span> <span style="color: #000000;">            context.beginPath();
</span><span style="color: #008080;">13</span>             context.fillStyle = 'rgb(100,255,100)'<span style="color: #000000;">;
</span><span style="color: #008080;">14</span>             context.strokeStyle = 'rgb(0,0,100)'<span style="color: #000000;">;
</span><span style="color: #008080;">15</span>             <span style="color: #0000ff;">var</span> x = Math.sin(0<span style="color: #000000;">);
</span><span style="color: #008080;">16</span>             <span style="color: #0000ff;">var</span> y = Math.cos(0<span style="color: #000000;">);
</span><span style="color: #008080;">17</span>             <span style="color: #0000ff;">var</span> dig = Math.PI / 15 * 11<span style="color: #000000;">;
</span><span style="color: #008080;">18</span>             <span style="color: #0000ff;">for</span> (<span style="color: #0000ff;">var</span> i = 0; i &lt; 30; i++<span style="color: #000000;">) {
</span><span style="color: #008080;">19</span>                 <span style="color: #0000ff;">var</span> x = Math.sin(i *<span style="color: #000000;"> dig);
</span><span style="color: #008080;">20</span>                 <span style="color: #0000ff;">var</span> y = Math.cos(i *<span style="color: #000000;"> dig);
</span><span style="color: #008080;">21</span>                 context.lineTo(dx + x * s, dy + y *<span style="color: #000000;"> s);
</span><span style="color: #008080;">22</span> <span style="color: #000000;">            }
</span><span style="color: #008080;">23</span> <span style="color: #000000;">            context.closePath();
</span><span style="color: #008080;">24</span> <span style="color: #000000;">            context.fill();
</span><span style="color: #008080;">25</span> <span style="color: #000000;">            context.stroke();
</span><span style="color: #008080;">26</span> 
<span style="color: #008080;">27</span>         }</pre>
</div>
</div>
<div class="arc_pic"><img src="../../images/bw3/2012080310315975.png" alt="" /></div>
<p>&nbsp;</p>
<p id="6"><strong>绘制贝塞尔曲线（贝济埃、bezier） context.bezierCurveTo(cp1x,cp1y,cp2x,cp2y,x,y)&nbsp; </strong></p>
<p><strong><strong>绘制二次样条曲线 </strong>context.quadraticCurveTo(qcpx,qcpy,qx,qy)<br /></strong></p>
<hr />
<p><em>&nbsp;&nbsp;&nbsp; cp1x:第一个控制点x坐标</em></p>
<p><em>&nbsp;&nbsp;&nbsp; cp1y:第一个控制点y坐标</em></p>
<p><em>&nbsp;&nbsp;&nbsp; cp2x:第二个控制点x坐标</em></p>
<p><em>&nbsp;&nbsp;&nbsp; cp2y:第二个控制点y坐标</em></p>
<p><em>&nbsp;&nbsp;&nbsp; x:终点x坐标</em></p>
<p><em>&nbsp;&nbsp;&nbsp; y:终点y坐标</em></p>
<p><em>&nbsp;</em></p>
<p><em>&nbsp;&nbsp;&nbsp; qcpx:二次样条曲线控制点x坐标</em></p>
<p><em>&nbsp;&nbsp;&nbsp; qcpy:二次样条曲线控制点y坐标</em></p>
<p><em>&nbsp;&nbsp;&nbsp; qx:二次样条曲线终点x坐标</em></p>
<p><em>&nbsp;&nbsp;&nbsp; qy:二次样条曲线终点y坐标</em></p>
<p>&nbsp;</p>
<div><b>View Code </b>
<div>
<pre><span style="color: #008080;"> 1</span>         <span style="color: #0000ff;">function</span><span style="color: #000000;"> draw24(id) {
</span><span style="color: #008080;"> 2</span>             <span style="color: #0000ff;">var</span> canvas =<span style="color: #000000;"> document.getElementById(id);
</span><span style="color: #008080;"> 3</span>             <span style="color: #0000ff;">if</span> (canvas == <span style="color: #0000ff;">null</span><span style="color: #000000;">) {
</span><span style="color: #008080;"> 4</span>                 <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">false</span><span style="color: #000000;">;
</span><span style="color: #008080;"> 5</span> <span style="color: #000000;">            }
</span><span style="color: #008080;"> 6</span>             <span style="color: #0000ff;">var</span> context = canvas.getContext("2d"<span style="color: #000000;">);
</span><span style="color: #008080;"> 7</span> 
<span style="color: #008080;"> 8</span>             context.moveTo(50, 50<span style="color: #000000;">);
</span><span style="color: #008080;"> 9</span>             context.bezierCurveTo(50, 50,150, 50, 150, 150<span style="color: #000000;">);
</span><span style="color: #008080;">10</span> <span style="color: #000000;">            context.stroke();
</span><span style="color: #008080;">11</span>             context.quadraticCurveTo(150, 250, 250, 250<span style="color: #000000;">);
</span><span style="color: #008080;">12</span> <span style="color: #000000;">            context.stroke();
</span><span style="color: #008080;">13</span>         }</pre>
</div>
</div>
<div class="arc_pic"><img src="../../images/bw3/2012080311052611.png" alt="" /></div>
<p>下面给出书本的例子，一朵扭曲的绿色菊花...编书这哥们对菊花情有独钟啊- -</p>
<div><b>View Code </b>
<div>
<pre><span style="color: #008080;"> 1</span>         <span style="color: #0000ff;">function</span><span style="color: #000000;"> draw2(id) {
</span><span style="color: #008080;"> 2</span>             <span style="color: #0000ff;">var</span> canvas =<span style="color: #000000;"> document.getElementById(id);
</span><span style="color: #008080;"> 3</span>             <span style="color: #0000ff;">if</span> (canvas == <span style="color: #0000ff;">null</span><span style="color: #000000;">) {
</span><span style="color: #008080;"> 4</span>                 <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">false</span><span style="color: #000000;">;
</span><span style="color: #008080;"> 5</span> <span style="color: #000000;">            }
</span><span style="color: #008080;"> 6</span>             <span style="color: #0000ff;">var</span> context = canvas.getContext("2d"<span style="color: #000000;">);
</span><span style="color: #008080;"> 7</span>             context.fillStyle = "#EEEFF"<span style="color: #000000;">;
</span><span style="color: #008080;"> 8</span>             context.fillRect(0, 0, 400, 300<span style="color: #000000;">);
</span><span style="color: #008080;"> 9</span>             <span style="color: #0000ff;">var</span> n = 0<span style="color: #000000;">;
</span><span style="color: #008080;">10</span>             <span style="color: #0000ff;">var</span> dx = 150<span style="color: #000000;">;
</span><span style="color: #008080;">11</span>             <span style="color: #0000ff;">var</span> dy = 150<span style="color: #000000;">;
</span><span style="color: #008080;">12</span>             <span style="color: #0000ff;">var</span> s = 100<span style="color: #000000;">;
</span><span style="color: #008080;">13</span> <span style="color: #000000;">            context.beginPath();
</span><span style="color: #008080;">14</span>             context.globalCompositeOperation = 'and'<span style="color: #000000;">;
</span><span style="color: #008080;">15</span>             context.fillStyle = 'rgb(100,255,100)'<span style="color: #000000;">;
</span><span style="color: #008080;">16</span>             <span style="color: #0000ff;">var</span> x = Math.sin(0<span style="color: #000000;">);
</span><span style="color: #008080;">17</span>             <span style="color: #0000ff;">var</span> y = Math.cos(0<span style="color: #000000;">);
</span><span style="color: #008080;">18</span>             <span style="color: #0000ff;">var</span> dig = Math.PI / 15 * 11<span style="color: #000000;">;
</span><span style="color: #008080;">19</span> <span style="color: #000000;">            context.moveTo(dx, dy);
</span><span style="color: #008080;">20</span>             <span style="color: #0000ff;">for</span> (<span style="color: #0000ff;">var</span> i = 0; i &lt; 30; i++<span style="color: #000000;">) {
</span><span style="color: #008080;">21</span>                 <span style="color: #0000ff;">var</span> x = Math.sin(i *<span style="color: #000000;"> dig);
</span><span style="color: #008080;">22</span>                 <span style="color: #0000ff;">var</span> y = Math.cos(i *<span style="color: #000000;"> dig);
</span><span style="color: #008080;">23</span>                 context.bezierCurveTo(dx + x * s, dy + y * s - 100, dx + x * s + 100, dy + y * s, dx + x * s, dy + y *<span style="color: #000000;"> s);
</span><span style="color: #008080;">24</span> <span style="color: #000000;">            }
</span><span style="color: #008080;">25</span> <span style="color: #000000;">            context.closePath();
</span><span style="color: #008080;">26</span> <span style="color: #000000;">            context.fill();
</span><span style="color: #008080;">27</span> <span style="color: #000000;">            context.stroke();
</span><span style="color: #008080;">28</span>         }</pre>
</div>
</div>
<div class="arc_pic"><img src="../../images/bw3/2012080311074866.png" alt="" /></div>
<p>&nbsp;</p>
<p id="7"><strong>&nbsp;线性渐变 var lg= context.createLinearGradient(xStart,yStart,xEnd,yEnd)</strong></p>
<p><strong>&nbsp;线性渐变颜色</strong><strong>lg.addColorStop(offset,color)<br /></strong></p>
<hr />
<p><em>&nbsp;&nbsp;&nbsp; xstart:渐变开始点x坐标</em></p>
<p><em>&nbsp;&nbsp;&nbsp; ystart:渐变开始点y坐标</em></p>
<p><em>&nbsp;&nbsp;&nbsp; xEnd:渐变结束点x坐标</em></p>
<p><em>&nbsp;&nbsp;&nbsp; yEnd:渐变结束点y坐标</em></p>
<p><em>&nbsp;</em></p>
<p><em>&nbsp;&nbsp;&nbsp; offset:设定的颜色离渐变结束点的偏移量(0~1)</em></p>
<p><em>&nbsp;&nbsp;&nbsp; color:绘制时要使用的颜色</em></p>
<p>&nbsp;</p>
<p>给出书本偏移量的解析图，从图可以看出线性渐变可以是两种以上颜色的渐变</p>
<div class="arc_pic"><img src="../../images/bw3/2012080311221852.png" alt="" /></div>
<div><b class="cnblogs_code_collapse">View Code </b>
<div>
<pre><span style="color: #008080;"> 1</span>         <span style="color: #0000ff;">function</span><span style="color: #000000;"> draw25(id) {
</span><span style="color: #008080;"> 2</span>             <span style="color: #0000ff;">var</span> canvas =<span style="color: #000000;"> document.getElementById(id);
</span><span style="color: #008080;"> 3</span>             <span style="color: #0000ff;">if</span> (canvas == <span style="color: #0000ff;">null</span><span style="color: #000000;">)
</span><span style="color: #008080;"> 4</span>                 <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">false</span><span style="color: #000000;">;
</span><span style="color: #008080;"> 5</span>             <span style="color: #0000ff;">var</span> context = canvas.getContext('2d'<span style="color: #000000;">);
</span><span style="color: #008080;"> 6</span>             <span style="color: #0000ff;">var</span> g1 = context.createLinearGradient(0, 0, 0, 300<span style="color: #000000;">);
</span><span style="color: #008080;"> 7</span> 
<span style="color: #008080;"> 8</span>             g1.addColorStop(0, 'rgb(255,0,0)'); <span style="color: #008000;">//</span><span style="color: #008000;">红  </span>
<span style="color: #008080;"> 9</span>             g1.addColorStop(0.5, 'rgb(0,255,0)');<span style="color: #008000;">//</span><span style="color: #008000;">绿</span>
<span style="color: #008080;">10</span>             g1.addColorStop(1, 'rgb(0,0,255)'); <span style="color: #008000;">//</span><span style="color: #008000;">蓝</span>
<span style="color: #008080;">11</span> 
<span style="color: #008080;">12</span>             <span style="color: #008000;">//</span><span style="color: #008000;">可以把lg对象理解成GDI中线性brush</span>
<span style="color: #008080;">13</span>             context.fillStyle =<span style="color: #000000;"> g1;
</span><span style="color: #008080;">14</span>             <span style="color: #008000;">//</span><span style="color: #008000;">再用这个brush来画正方形</span>
<span style="color: #008080;">15</span>             context.fillRect(0, 0, 400, 300<span style="color: #000000;">);  
</span><span style="color: #008080;">16</span>         }</pre>
</div>
</div>
<div class="arc_pic"><img src="../../images/bw3/2012080311411922.png" alt="" /></div>
<p>&nbsp;<a href="#top">顶部</a></p>
<p>&nbsp;</p>
<p id="8"><strong>径向渐变（发散）var rg=context.createRadialGradient(xStart,yStart,radiusStart,xEnd,yEnd,radiusEnd)</strong></p>
<p><strong>径向渐变（发散）颜色r</strong><strong>g.addColorStop(offset,color)</strong></p>
<hr />
<p><em>&nbsp;&nbsp;&nbsp; xStart:发散开始圆心x坐标</em></p>
<p><em>&nbsp;&nbsp;&nbsp; yStart:发散开始圆心y坐标</em></p>
<p><em>&nbsp;&nbsp;&nbsp; radiusStart:发散开始圆的半径</em></p>
<p><em>&nbsp;&nbsp;&nbsp; xEnd:发散结束圆心的x坐标</em></p>
<p><em>&nbsp;&nbsp;&nbsp; yEnd:发散结束圆心的y坐标</em></p>
<p><em>&nbsp;&nbsp;&nbsp; radiusEnd:发散结束圆的半径</em></p>
<p><em>&nbsp;</em></p>
<p><em>&nbsp;&nbsp;&nbsp; offset:设定的颜色离渐变结束点的偏移量(0~1)</em></p>
<p><em>&nbsp;&nbsp;&nbsp; color:绘制时要使用的颜色</em></p>
<p>书本并没有给出发散偏移量的图，特地画了幅：</p>
<div class="arc_pic"><img src="../../images/bw3/2012080314164328.png" alt="" /></div>
<p>下面给出两个实验</p>
<p>&nbsp;</p>
<div><b>View Code </b>
<div>
<pre><span style="color: #008080;"> 1</span>         <span style="color: #0000ff;">function</span><span style="color: #000000;"> draw26(id) {
</span><span style="color: #008080;"> 2</span>             <span style="color: #008000;">//</span><span style="color: #008000;">同一个圆心画球型</span>
<span style="color: #008080;"> 3</span>             <span style="color: #008000;">/*</span><span style="color: #008000;">var canvas = document.getElementById(id);
</span><span style="color: #008080;"> 4</span> <span style="color: #008000;">            if (canvas == null)
</span><span style="color: #008080;"> 5</span> <span style="color: #008000;">                return false;
</span><span style="color: #008080;"> 6</span> <span style="color: #008000;">            var context = canvas.getContext('2d');
</span><span style="color: #008080;"> 7</span> <span style="color: #008000;">            var g1 = context.createRadialGradient(200, 150, 0, 200, 150, 100);
</span><span style="color: #008080;"> 8</span> <span style="color: #008000;">            g1.addColorStop(0.1, 'rgb(255,0,0)');  
</span><span style="color: #008080;"> 9</span> <span style="color: #008000;">            g1.addColorStop(1, 'rgb(50,0,0)');
</span><span style="color: #008080;">10</span> <span style="color: #008000;">            context.fillStyle = g1;
</span><span style="color: #008080;">11</span> <span style="color: #008000;">            context.beginPath();
</span><span style="color: #008080;">12</span> <span style="color: #008000;">            context.arc(200, 150, 100, 0, Math.PI * 2, true);
</span><span style="color: #008080;">13</span> <span style="color: #008000;">            context.closePath();
</span><span style="color: #008080;">14</span> <span style="color: #008000;">            context.fill();</span><span style="color: #008000;">*/</span>
<span style="color: #008080;">15</span>           
<span style="color: #008080;">16</span>             <span style="color: #008000;">//</span><span style="color: #008000;">不同圆心看径向渐变模型</span>
<span style="color: #008080;">17</span>             <span style="color: #0000ff;">var</span> canvas =<span style="color: #000000;"> document.getElementById(id);
</span><span style="color: #008080;">18</span>             <span style="color: #0000ff;">if</span> (canvas == <span style="color: #0000ff;">null</span><span style="color: #000000;">)
</span><span style="color: #008080;">19</span>             <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">false</span><span style="color: #000000;">;
</span><span style="color: #008080;">20</span>             <span style="color: #0000ff;">var</span> context = canvas.getContext('2d'<span style="color: #000000;">);
</span><span style="color: #008080;">21</span>             <span style="color: #0000ff;">var</span> g1 = context.createRadialGradient(100, 150, 10, 300, 150, 50<span style="color: #000000;">);
</span><span style="color: #008080;">22</span>             g1.addColorStop(0.1, 'rgb(255,0,0)'<span style="color: #000000;">);
</span><span style="color: #008080;">23</span>             g1.addColorStop(0.5, 'rgb(0,255,0)'<span style="color: #000000;">);
</span><span style="color: #008080;">24</span>             g1.addColorStop(1, 'rgb(0,0,255)'<span style="color: #000000;">);
</span><span style="color: #008080;">25</span>             context.fillStyle =<span style="color: #000000;"> g1;
</span><span style="color: #008080;">26</span>             context.fillRect(0, 0, 400, 300<span style="color: #000000;">);
</span><span style="color: #008080;">27</span>    
<span style="color: #008080;">28</span>         }</pre>
</div>
</div>
<div class="arc_pic"><img src="../../images/bw3/2012080314260820.png" alt="" /></div>
<div class="arc_pic"><img src="../../images/bw3/2012080314262429.png" alt="" /></div>
<p>&nbsp;<a href="#top">顶部</a></p>
<p>&nbsp;</p>
<p id="9">&nbsp;<strong>图形变形</strong></p>
<hr />
<p><em>1、平移context.translate(x,y)</em></p>
<p><em>&nbsp;&nbsp;&nbsp; x:坐标原点向x轴方向平移x</em></p>
<p><em>&nbsp;&nbsp;&nbsp; y:坐标原点向y轴方向平移y</em></p>
<p><em>2、缩放context.scale(x,y)</em></p>
<p><em>&nbsp;&nbsp;&nbsp; x:x坐标轴按x比例缩放</em></p>
<p><em>&nbsp;&nbsp;&nbsp; y:y坐标轴按y比例缩放</em></p>
<p><em>3、旋转context.rotate(angle)</em></p>
<p><em>&nbsp;&nbsp;&nbsp; angle:坐标轴旋转x角度（角度变化模型和画圆的模型一样）</em></p>
<div><b>View Code </b>
<div>
<pre><span style="color: #008080;"> 1</span>         <span style="color: #0000ff;">function</span><span style="color: #000000;"> draw5(id) {
</span><span style="color: #008080;"> 2</span>             <span style="color: #0000ff;">var</span> canvas =<span style="color: #000000;"> document.getElementById(id);
</span><span style="color: #008080;"> 3</span>             <span style="color: #0000ff;">if</span> (canvas == <span style="color: #0000ff;">null</span><span style="color: #000000;">)
</span><span style="color: #008080;"> 4</span>                 <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">false</span><span style="color: #000000;">;
</span><span style="color: #008080;"> 5</span> 
<span style="color: #008080;"> 6</span> 
<span style="color: #008080;"> 7</span>             <span style="color: #0000ff;">var</span> context = canvas.getContext("2d"<span style="color: #000000;">);
</span><span style="color: #008080;"> 8</span>             context.save(); <span style="color: #008000;">//</span><span style="color: #008000;">保存了当前context的状态</span>
<span style="color: #008080;"> 9</span>             context.fillStyle = "#EEEEFF"<span style="color: #000000;">;
</span><span style="color: #008080;">10</span>             context.fillRect(0, 0, 400, 300<span style="color: #000000;">);
</span><span style="color: #008080;">11</span> 
<span style="color: #008080;">12</span>             context.fillStyle = "rgba(255,0,0,0.1)"<span style="color: #000000;">;
</span><span style="color: #008080;">13</span>             <span style="color: #008000;">//</span><span style="color: #008000;">平移 缩放 旋转  1 2 3        </span>
<span style="color: #008080;">14</span>             context.translate(100, 100<span style="color: #000000;">);
</span><span style="color: #008080;">15</span>             context.scale(0.5, 0.5<span style="color: #000000;">);
</span><span style="color: #008080;">16</span>             context.rotate(Math.PI / 4<span style="color: #000000;">);
</span><span style="color: #008080;">17</span>             context.fillRect(0, 0, 100, 100<span style="color: #000000;">);
</span><span style="color: #008080;">18</span> 
<span style="color: #008080;">19</span> 
<span style="color: #008080;">20</span>             context.restore(); <span style="color: #008000;">//</span><span style="color: #008000;">恢复到刚刚保存的状态,保存恢复只能使用一次</span>
<span style="color: #008080;">21</span>             context.save(); <span style="color: #008000;">//</span><span style="color: #008000;">保存了当前context的状态</span>
<span style="color: #008080;">22</span>             context.fillStyle = "rgba(255,0,0,0.2)"<span style="color: #000000;">;
</span><span style="color: #008080;">23</span>             <span style="color: #008000;">//</span><span style="color: #008000;">平移 旋转 缩放 1 3 2</span>
<span style="color: #008080;">24</span>             context.translate(100, 100<span style="color: #000000;">);
</span><span style="color: #008080;">25</span>             context.rotate(Math.PI / 4<span style="color: #000000;">);
</span><span style="color: #008080;">26</span>             context.scale(0.5, 0.5<span style="color: #000000;">);
</span><span style="color: #008080;">27</span>             context.fillRect(0, 0, 100, 100<span style="color: #000000;">);
</span><span style="color: #008080;">28</span> 
<span style="color: #008080;">29</span>             context.restore(); <span style="color: #008000;">//</span><span style="color: #008000;">恢复到刚刚保存的状态</span>
<span style="color: #008080;">30</span>             context.save(); <span style="color: #008000;">//</span><span style="color: #008000;">保存了当前context的状态</span>
<span style="color: #008080;">31</span>             context.fillStyle = "rgba(255,0,0,0.3)"<span style="color: #000000;">;
</span><span style="color: #008080;">32</span>             <span style="color: #008000;">//</span><span style="color: #008000;">缩放 平移 旋转 2 1 3 </span>
<span style="color: #008080;">33</span>             context.scale(0.5, 0.5<span style="color: #000000;">);
</span><span style="color: #008080;">34</span>             context.translate(100, 100<span style="color: #000000;">);
</span><span style="color: #008080;">35</span>             context.rotate(Math.PI / 4<span style="color: #000000;">);
</span><span style="color: #008080;">36</span>             context.fillRect(0, 0, 100, 100<span style="color: #000000;">);
</span><span style="color: #008080;">37</span> 
<span style="color: #008080;">38</span>             context.restore(); <span style="color: #008000;">//</span><span style="color: #008000;">恢复到刚刚保存的状态</span>
<span style="color: #008080;">39</span>             context.save(); <span style="color: #008000;">//</span><span style="color: #008000;">保存了当前context的状态</span>
<span style="color: #008080;">40</span>             context.fillStyle = "rgba(255,0,0,0.4)"<span style="color: #000000;">;
</span><span style="color: #008080;">41</span>             <span style="color: #008000;">//</span><span style="color: #008000;">缩放 旋转 平移  2 3  1 </span>
<span style="color: #008080;">42</span>             context.scale(0.5, 0.5<span style="color: #000000;">);
</span><span style="color: #008080;">43</span>             context.rotate(Math.PI / 4<span style="color: #000000;">);
</span><span style="color: #008080;">44</span>             context.translate(100, 100<span style="color: #000000;">);
</span><span style="color: #008080;">45</span>             context.fillRect(0, 0, 100, 100<span style="color: #000000;">);
</span><span style="color: #008080;">46</span> 
<span style="color: #008080;">47</span>             context.restore(); <span style="color: #008000;">//</span><span style="color: #008000;">恢复到刚刚保存的状态</span>
<span style="color: #008080;">48</span>             context.save(); <span style="color: #008000;">//</span><span style="color: #008000;">保存了当前context的状态</span>
<span style="color: #008080;">49</span>             context.fillStyle = "rgba(255,0,0,0.5)"<span style="color: #000000;">;
</span><span style="color: #008080;">50</span>             <span style="color: #008000;">//</span><span style="color: #008000;">旋转 平移 缩放  3 1 2 </span>
<span style="color: #008080;">51</span>             context.rotate(Math.PI / 4<span style="color: #000000;">);
</span><span style="color: #008080;">52</span>             context.translate(100, 100<span style="color: #000000;">);
</span><span style="color: #008080;">53</span>             context.scale(0.5, 0.5<span style="color: #000000;">);
</span><span style="color: #008080;">54</span>             context.fillRect(0, 0, 100, 100<span style="color: #000000;">);
</span><span style="color: #008080;">55</span> 
<span style="color: #008080;">56</span>             context.restore(); <span style="color: #008000;">//</span><span style="color: #008000;">恢复到刚刚保存的状态</span>
<span style="color: #008080;">57</span>             context.save(); <span style="color: #008000;">//</span><span style="color: #008000;">保存了当前context的状态</span>
<span style="color: #008080;">58</span>             context.fillStyle = "rgba(255,0,0,1)"<span style="color: #000000;">;
</span><span style="color: #008080;">59</span>             <span style="color: #008000;">//</span><span style="color: #008000;">旋转 缩放 平移   3 2 1 </span>
<span style="color: #008080;">60</span>             context.rotate(Math.PI / 4<span style="color: #000000;">);
</span><span style="color: #008080;">61</span>             context.scale(0.5, 0.5<span style="color: #000000;">);
</span><span style="color: #008080;">62</span>             context.translate(100, 100<span style="color: #000000;">);
</span><span style="color: #008080;">63</span>             context.fillRect(0, 0, 100, 100<span style="color: #000000;">);
</span><span style="color: #008080;">64</span> 
<span style="color: #008080;">65</span>             <span style="color: #008000;">//</span><span style="color: #008000;">实验表明应该移动的是坐标轴</span>
<span style="color: #008080;">66</span>             <span style="color: #008000;">//</span><span style="color: #008000;">实验表明缩放的是坐标轴比例</span>
<span style="color: #008080;">67</span>             <span style="color: #008000;">//</span><span style="color: #008000;">实验表明旋转的是坐标轴</span>
<span style="color: #008080;">68</span>             <span style="color: #008000;">//</span><span style="color: #008000;">综合上述，因此平移 缩放 旋转 三者的顺序不同都将画出不同的结果</span>
<span style="color: #008080;">69</span>         }</pre>
</div>
</div>
<p>由于（平移，缩放，旋转）和（平移，旋转，缩放）一样</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp; （缩放，选装，平移）和（旋转，缩放，平移）一样</p>
<p>所以实验结果只能看到&ldquo;4&rdquo;中情况，其实是有两种情况被覆盖了</p>
<div class="arc_pic"><img src="../../images/bw3/2012080315533679.png" alt="" /></div>
<p>下面给出平移，缩放，旋转先后顺序不同，坐标轴的变化图</p>
<div class="arc_pic"><img src="../../images/bw3/2012080316350654.png" alt="" /></div>
<p>&nbsp;<a href="#top">顶部</a></p>
<p>&nbsp;</p>
<p id="10"><strong>矩阵变换 context.transform(m11,m12,m21,m22,dx,dy)<br /></strong></p>
<hr />
<p>&nbsp;&nbsp;&nbsp; 所谓的矩阵变换其实是context内实现平移，缩放，旋转的一种机制<strong><br /></strong></p>
<p>&nbsp;&nbsp;&nbsp; 他的主要原理就是矩阵相乘</p>
<p>&nbsp;&nbsp;&nbsp; 额，要讲解这个可以另开一个篇幅，庆幸的是已经有人做了总结，可以参考下面这篇文章</p>
<p>&nbsp;&nbsp;&nbsp; <a href="http://hi.baidu.com/100912bb_bb/item/90c4a7489518b0fa1281daf1">http://hi.baidu.com/100912bb_bb/item/90c4a7489518b0fa1281daf1</a></p>
<p>&nbsp;&nbsp;&nbsp; 我们需要了解的是</p>
<p>&nbsp;&nbsp;&nbsp; context.translate(x,y) 等同于context.transform (1,0,0,1,x,y)或context.transform(0,1,1,0.x,y)</p>
<p><br />&nbsp;&nbsp;&nbsp; context.scale(x,y)等同于context.transform(x,0,0,y,0,0)或context.transform (0,y,x,0, 0,0);</p>
<p>&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp; context.rotate(&theta;)等同于&nbsp;&nbsp; </p>
<p>&nbsp;&nbsp;&nbsp; context.transform(Math.cos(&theta;*Math.PI/180)，Math.sin(&theta;*Math.PI/180),</p>
<p>&nbsp;&nbsp;&nbsp; -Math.sin(&theta;*Math.PI/180),Math.cos(&theta;*Math.PI/180)，0，0）</p>
<p>&nbsp;&nbsp;&nbsp; 或</p>
<p>&nbsp;&nbsp;&nbsp; context.transform(-Math.sin(&theta;*Math.PI/180),Math.cos(&theta;*Math.PI/180)，</p>
<p>&nbsp;&nbsp;&nbsp; Math.cos(&theta;*Math.PI/180)，Math.sin(&theta;*Math.PI/180), 0，0）</p>
<p>&nbsp;</p>
<p><strong>&nbsp;</strong><a href="#top">顶部</a></p>
<p><strong>&nbsp;</strong></p>
<p id="11"><strong>图形组合 context.globalCompositeOperation=type<br /></strong></p>
<hr />
<p><strong>&nbsp;&nbsp;&nbsp;</strong> 图形组合就是两个图形相互叠加了图形的表现形式,是后画的覆盖掉先画的呢，还是相互重叠的部分不显示等等，至于怎么显示就取决于type的值了<strong><br /></strong></p>
<p>&nbsp;&nbsp;&nbsp; type：</p>
<p><em>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; source-over（默认值）:在原有图形上绘制新图形</em></p>
<p><em>&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; destination-over:在原有图形下绘制新图形</em></p>
<p><em>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; source-in:显示原有图形和新图形的交集，新图形在上，所以颜色为新图形的颜色</em></p>
<p><em>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; destination-in:显示原有图形和新图形的交集，原有图形在上，所以颜色为原有图形的颜色</em></p>
<p><em>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; source-out:只显示新图形非交集部分</em></p>
<p><em>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; destination-out:只显示原有图形非交集部分</em></p>
<p><em>&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; source-atop:显示原有图形和交集部分，新图形在上，所以交集部分的颜色为新图形的颜色</em></p>
<p><em>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; destination-atop:显示新图形和交集部分，新图形在下，所以交集部分的颜色为原有图形的颜色</em></p>
<p><em>&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lighter:原有图形和新图形都显示，交集部分做颜色叠加</em></p>
<p><em>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; xor:重叠飞部分不现实</em></p>
<p><em>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; copy:只显示新图形</em></p>
<p>&nbsp;&nbsp;&nbsp; 文字看得人眼花缭乱，特意画图一张：回头一看惊觉打错字，图片的原型为圆形，你懂的- -</p>
<div class="arc_pic"><img src="../../images/bw3/2012080317515321.png" alt="" /></div>
<p>以下为实验代码</p>
<div><b>View Code </b>
<div>
<pre><span style="color: #008080;"> 1</span>         <span style="color: #0000ff;">function</span><span style="color: #000000;"> draw10(id) {
</span><span style="color: #008080;"> 2</span>             <span style="color: #0000ff;">var</span> canvas =<span style="color: #000000;"> document.getElementById(id);
</span><span style="color: #008080;"> 3</span>             <span style="color: #0000ff;">if</span> (canvas == <span style="color: #0000ff;">null</span><span style="color: #000000;">) {
</span><span style="color: #008080;"> 4</span>                 <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">false</span><span style="color: #000000;">;
</span><span style="color: #008080;"> 5</span> <span style="color: #000000;">            }
</span><span style="color: #008080;"> 6</span>             <span style="color: #0000ff;">var</span> context = canvas.getContext("2d"<span style="color: #000000;">);
</span><span style="color: #008080;"> 7</span>             <span style="color: #0000ff;">var</span> oprtns = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Array(
</span><span style="color: #008080;"> 8</span>             "source-over"<span style="color: #000000;">,
</span><span style="color: #008080;"> 9</span>             "destination-over"<span style="color: #000000;">,
</span><span style="color: #008080;">10</span>             "source-in"<span style="color: #000000;">,
</span><span style="color: #008080;">11</span>             "destination-in"<span style="color: #000000;">,
</span><span style="color: #008080;">12</span>             "source-out"<span style="color: #000000;">,
</span><span style="color: #008080;">13</span>             "destination-out"<span style="color: #000000;">,
</span><span style="color: #008080;">14</span>             "source-atop"<span style="color: #000000;">,
</span><span style="color: #008080;">15</span>             "destination-atop"<span style="color: #000000;">,
</span><span style="color: #008080;">16</span>             "lighter"<span style="color: #000000;">,
</span><span style="color: #008080;">17</span>             "xor"<span style="color: #000000;">,         
</span><span style="color: #008080;">18</span>             "copy"
<span style="color: #008080;">19</span> <span style="color: #000000;">            );
</span><span style="color: #008080;">20</span>            <span style="color: #0000ff;">var</span> i = 0;<span style="color: #008000;">//</span><span style="color: #008000;">组合效果编号</span>
<span style="color: #008080;">21</span>       
<span style="color: #008080;">22</span>            <span style="color: #008000;">//</span><span style="color: #008000;">结合setinterval动态显示组合</span>
<span style="color: #008080;">23</span>            <span style="color: #0000ff;">var</span> interal = setInterval(<span style="color: #0000ff;">function</span><span style="color: #000000;"> () {
</span><span style="color: #008080;">24</span>                <span style="color: #0000ff;">if</span> (i == 10<span style="color: #000000;">) {
</span><span style="color: #008080;">25</span>                    i=0<span style="color: #000000;">;
</span><span style="color: #008080;">26</span> <span style="color: #000000;">               }
</span><span style="color: #008080;">27</span>                <span style="color: #0000ff;">else</span><span style="color: #000000;"> {
</span><span style="color: #008080;">28</span>                    i++<span style="color: #000000;">;
</span><span style="color: #008080;">29</span> <span style="color: #000000;">               }
</span><span style="color: #008080;">30</span>                <span style="color: #008000;">//</span><span style="color: #008000;">蓝色矩形</span>
<span style="color: #008080;">31</span>                context.fillStyle = "blue"<span style="color: #000000;">;
</span><span style="color: #008080;">32</span>                context.fillRect(10, 10, 60, 60<span style="color: #000000;">);
</span><span style="color: #008080;">33</span>                <span style="color: #008000;">//</span><span style="color: #008000;">设置组合方式 </span>
<span style="color: #008080;">34</span>                context.globalCompositeOperation =<span style="color: #000000;"> oprtns[i];
</span><span style="color: #008080;">35</span>                <span style="color: #008000;">//</span><span style="color: #008000;">设置新图形（红色圆形）</span>
<span style="color: #008080;">36</span> <span style="color: #000000;">               context.beginPath();
</span><span style="color: #008080;">37</span>                context.fillStyle = "red"<span style="color: #000000;">;
</span><span style="color: #008080;">38</span>                context.arc(60, 60, 30, 0, Math.PI * 2, <span style="color: #0000ff;">false</span><span style="color: #000000;">);
</span><span style="color: #008080;">39</span> <span style="color: #000000;">               context.fill();
</span><span style="color: #008080;">40</span>           }, 1000<span style="color: #000000;">);
</span><span style="color: #008080;">41</span>            
<span style="color: #008080;">42</span>         }</pre>
</div>
</div>
<p>&nbsp;结果是动态的切换各种组合</p>
<div class="arc_pic"><img src="../../images/bw3/2012080318111928.png" alt="" /></div>

<p>&nbsp;</p>
<p id="12"><strong>给图形绘制阴影<br /></strong></p>
<hr />
<p><em>&nbsp;&nbsp;&nbsp; context.shadowOffsetX :阴影的横向位移量（默认值为0）</em><br /><em>&nbsp;&nbsp;&nbsp; context.shadowOffsetY :阴影的纵向位移量（默认值为0）</em><br /><em>&nbsp;&nbsp;&nbsp; context.shadowColor :阴影的颜色</em><br /><em>&nbsp;&nbsp;&nbsp; context.shadowBlur :阴影的模糊范围（值越大越模糊）</em></p>
<p>先来个简单的例子</p>
<div><b>View Code</b>
<div>
<pre><span style="color: #008080;"> 1</span>         <span style="color: #0000ff;">function</span><span style="color: #000000;"> draw27(id) {
</span><span style="color: #008080;"> 2</span>             <span style="color: #0000ff;">var</span> canvas =<span style="color: #000000;"> document.getElementById(id);
</span><span style="color: #008080;"> 3</span>             <span style="color: #0000ff;">if</span> (canvas == <span style="color: #0000ff;">null</span><span style="color: #000000;">)
</span><span style="color: #008080;"> 4</span>                 <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">false</span><span style="color: #000000;">;
</span><span style="color: #008080;"> 5</span>             <span style="color: #0000ff;">var</span> context = canvas.getContext('2d'<span style="color: #000000;">);
</span><span style="color: #008080;"> 6</span>             context.shadowOffsetX = 10<span style="color: #000000;">;
</span><span style="color: #008080;"> 7</span>             context.shadowOffsetY = 10<span style="color: #000000;">;
</span><span style="color: #008080;"> 8</span>             context.shadowColor = 'rgba(100,100,100,0.5)'<span style="color: #000000;">;
</span><span style="color: #008080;"> 9</span>             context.shadowBlur = 1.5<span style="color: #000000;">;
</span><span style="color: #008080;">10</span>             context.fillStyle = 'rgba(255,0,0,0.5)'<span style="color: #000000;">;
</span><span style="color: #008080;">11</span>             context.fillRect(100, 100, 200, 100<span style="color: #000000;">);
</span><span style="color: #008080;">12</span>         }</pre>
</div>
</div>
<div class="arc_pic"><img src="../../images/bw3/2012080409450312.png" alt="" /></div>
<p>&nbsp;再来个书本上的五角星的例子</p>
<div ><b>View Code </b>
<div>
<pre><span style="color: #008080;"> 1</span>         <span style="color: #0000ff;">function</span><span style="color: #000000;"> create5Star(context) {
</span><span style="color: #008080;"> 2</span>             <span style="color: #0000ff;">var</span> n = 0<span style="color: #000000;">;
</span><span style="color: #008080;"> 3</span>             <span style="color: #0000ff;">var</span> dx = 100<span style="color: #000000;">;
</span><span style="color: #008080;"> 4</span>             <span style="color: #0000ff;">var</span> dy = 0<span style="color: #000000;">;
</span><span style="color: #008080;"> 5</span> 
<span style="color: #008080;"> 6</span>             <span style="color: #0000ff;">var</span> s = 50<span style="color: #000000;">;
</span><span style="color: #008080;"> 7</span>             <span style="color: #008000;">//</span><span style="color: #008000;">创建路径</span>
<span style="color: #008080;"> 8</span> <span style="color: #000000;">            context.beginPath();
</span><span style="color: #008080;"> 9</span>             context.fillStyle = 'rgba(255,0,0,0.5)'<span style="color: #000000;">;
</span><span style="color: #008080;">10</span>             <span style="color: #0000ff;">var</span> x = Math.sin(0<span style="color: #000000;">);
</span><span style="color: #008080;">11</span>             <span style="color: #0000ff;">var</span> y = Math.cos(0<span style="color: #000000;">);
</span><span style="color: #008080;">12</span>             <span style="color: #0000ff;">var</span> dig = Math.PI / 5 * 4<span style="color: #000000;">;
</span><span style="color: #008080;">13</span>             <span style="color: #0000ff;">for</span> (<span style="color: #0000ff;">var</span> i = 0; i &lt; 5; i++<span style="color: #000000;">) {
</span><span style="color: #008080;">14</span>                 <span style="color: #0000ff;">var</span> x = Math.sin(i *<span style="color: #000000;"> dig);
</span><span style="color: #008080;">15</span>                 <span style="color: #0000ff;">var</span> y = Math.cos(i *<span style="color: #000000;"> dig);
</span><span style="color: #008080;">16</span>                 context.lineTo(dx + x * s, dy + y *<span style="color: #000000;"> s);
</span><span style="color: #008080;">17</span> 
<span style="color: #008080;">18</span> <span style="color: #000000;">            }
</span><span style="color: #008080;">19</span> <span style="color: #000000;">            context.closePath();
</span><span style="color: #008080;">20</span> 
<span style="color: #008080;">21</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">22</span> 
<span style="color: #008080;">23</span>         <span style="color: #0000ff;">function</span><span style="color: #000000;"> draw11(id) {
</span><span style="color: #008080;">24</span>             <span style="color: #0000ff;">var</span> canvas =<span style="color: #000000;"> document.getElementById(id);
</span><span style="color: #008080;">25</span>             <span style="color: #0000ff;">if</span> (canvas == <span style="color: #0000ff;">null</span><span style="color: #000000;">)
</span><span style="color: #008080;">26</span>                 <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">false</span><span style="color: #000000;">;
</span><span style="color: #008080;">27</span>             <span style="color: #0000ff;">var</span> context = canvas.getContext("2d"<span style="color: #000000;">);
</span><span style="color: #008080;">28</span>             context.fillStyle = "#EEEEFF"<span style="color: #000000;">;
</span><span style="color: #008080;">29</span>             context.fillRect(0, 0, 400, 300<span style="color: #000000;">);
</span><span style="color: #008080;">30</span>          
<span style="color: #008080;">31</span>             context.shadowOffsetX = 10<span style="color: #000000;">;
</span><span style="color: #008080;">32</span>             context.shadowOffsetY = 10<span style="color: #000000;">;
</span><span style="color: #008080;">33</span>             context.shadowColor = 'rgba(100,100,100,0.5)'<span style="color: #000000;">;
</span><span style="color: #008080;">34</span>             context.shadowBlur =5<span style="color: #000000;">;
</span><span style="color: #008080;">35</span>             <span style="color: #008000;">//</span><span style="color: #008000;">图形绘制</span>
<span style="color: #008080;">36</span>             context.translate(0, 50<span style="color: #000000;">);
</span><span style="color: #008080;">37</span>             <span style="color: #0000ff;">for</span> (<span style="color: #0000ff;">var</span> i = 0; i &lt; 3; i++<span style="color: #000000;">) {
</span><span style="color: #008080;">38</span>                 context.translate(50, 50<span style="color: #000000;">);
</span><span style="color: #008080;">39</span> <span style="color: #000000;">                create5Star(context);
</span><span style="color: #008080;">40</span> <span style="color: #000000;">                context.fill();
</span><span style="color: #008080;">41</span> <span style="color: #000000;">            }
</span><span style="color: #008080;">42</span>         }</pre>
</div>
</div>
<div class="arc_pic"><img src="../../images/bw3/2012080409534793.png" alt="" /></div>
<p>&nbsp;</p>
<p id="13"><strong>绘制图像&nbsp;</strong></p>
<p><strong>绘图：context.drawImage<br /></strong></p>
<p><strong>图像平铺：context.createPattern(image,type)</strong></p>
<p><strong>图像裁剪：context.clip()</strong></p>
<p><strong>像素处理：var imagedata=context.getImageData(sx,sy,sw,sh)<br /></strong></p>
<hr />
<p><strong>绘图 <strong>context.drawImage</strong></strong></p>
<p>&nbsp;&nbsp;&nbsp; context.drawImage(image,x,y)</p>
<p><em>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; image:Image对象var img=new Image(); img.src="url(...)";</em></p>
<p><em>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; x:绘制图像的x坐标</em></p>
<p><em>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; y:绘制图像的y坐标</em></p>
<p>&nbsp;&nbsp;&nbsp; context.drawImage(image,x,y,w,h)</p>
<p><em>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; image:Image对象var img=new Image(); img.src="url(...)";</em></p>
<p><em>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; x:绘制图像的x坐标</em></p>
<p><em>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; y:绘制图像的y坐标</em></p>
<p><em>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; w:绘制图像的宽度</em></p>
<p><em>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; h:绘制图像的高度</em></p>
<p>&nbsp;&nbsp;&nbsp; context.drawImage(image,sx,sy,sw,sh,dx,dy,dw,dh):选取图像的一部分矩形区域进行绘制</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <em>image:Image对象var img=new Image(); img.src="url(...)";</em></p>
<p><em>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sx：图像上的x坐标<br /></em></p>
<p><em>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sy：图像上的y坐标<br /></em></p>
<p><em>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sw：矩形区域的宽度<br /></em></p>
<p><em>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sh：矩形区域的高度<br /></em></p>
<p><em>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dx：画在canvas的x坐标<br /></em></p>
<p><em>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dy：<em>画在canvas的y坐标</em><br /></em></p>
<p><em>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dw：画出来的宽度<br /></em></p>
<p><em>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dh：画出来的高度<br /></em></p>
<p><em>&nbsp;&nbsp;&nbsp;</em> 最后一个方法可能比较拗，还是上图吧<em><br /></em></p>
<p><img src="../../images/bw3/2012080410231479.png" alt="" /></p>
<div><b>View Code </b>
<div>
<pre><span style="color: #008080;"> 1</span>         <span style="color: #008000;">//</span><span style="color: #008000;">drawImage(image,x,y)</span>
<span style="color: #008080;"> 2</span>         <span style="color: #0000ff;">function</span><span style="color: #000000;"> draw28(id) {
</span><span style="color: #008080;"> 3</span> 
<span style="color: #008080;"> 4</span>             <span style="color: #0000ff;">var</span> image = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Image();
</span><span style="color: #008080;"> 5</span> 
<span style="color: #008080;"> 6</span>             image.src = "Image/html5.jpg"<span style="color: #000000;">;
</span><span style="color: #008080;"> 7</span>             <span style="color: #0000ff;">var</span> canvas =<span style="color: #000000;"> document.getElementById(id);
</span><span style="color: #008080;"> 8</span> 
<span style="color: #008080;"> 9</span>             <span style="color: #0000ff;">if</span> (canvas == <span style="color: #0000ff;">null</span><span style="color: #000000;">)
</span><span style="color: #008080;">10</span>                 <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">false</span><span style="color: #000000;">;
</span><span style="color: #008080;">11</span>             <span style="color: #0000ff;">var</span> context = canvas.getContext("2d"<span style="color: #000000;">);
</span><span style="color: #008080;">12</span>             context.fillStyle = "#EEEEFF"<span style="color: #000000;">;
</span><span style="color: #008080;">13</span> 
<span style="color: #008080;">14</span>             context.fillRect(0, 0, 400, 300<span style="color: #000000;">);
</span><span style="color: #008080;">15</span>             image.onload = <span style="color: #0000ff;">function</span><span style="color: #000000;"> () {
</span><span style="color: #008080;">16</span>                 context.drawImage(image,0,0<span style="color: #000000;">);
</span><span style="color: #008080;">17</span> <span style="color: #000000;">            }
</span><span style="color: #008080;">18</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">19</span> 
<span style="color: #008080;">20</span>         <span style="color: #008000;">//</span><span style="color: #008000;">drawImage(image,x,y,w,h)</span>
<span style="color: #008080;">21</span>         <span style="color: #0000ff;">function</span><span style="color: #000000;"> draw12(id) {
</span><span style="color: #008080;">22</span>           
<span style="color: #008080;">23</span>             <span style="color: #0000ff;">var</span> image = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Image();
</span><span style="color: #008080;">24</span> 
<span style="color: #008080;">25</span>             image.src = "Image/html5.jpg"<span style="color: #000000;">;
</span><span style="color: #008080;">26</span>             <span style="color: #0000ff;">var</span> canvas =<span style="color: #000000;"> document.getElementById(id);
</span><span style="color: #008080;">27</span> 
<span style="color: #008080;">28</span>             <span style="color: #0000ff;">if</span> (canvas == <span style="color: #0000ff;">null</span><span style="color: #000000;">)
</span><span style="color: #008080;">29</span>                 <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">false</span><span style="color: #000000;">;
</span><span style="color: #008080;">30</span>             <span style="color: #0000ff;">var</span> context = canvas.getContext("2d"<span style="color: #000000;">);
</span><span style="color: #008080;">31</span>             context.fillStyle = "#EEEEFF"<span style="color: #000000;">;
</span><span style="color: #008080;">32</span>            
<span style="color: #008080;">33</span>             context.fillRect(0, 0, 400, 300<span style="color: #000000;">);
</span><span style="color: #008080;">34</span>             image.onload = <span style="color: #0000ff;">function</span><span style="color: #000000;"> () {
</span><span style="color: #008080;">35</span>                 context.drawImage(image, 50, 50, 300, 200<span style="color: #000000;">);
</span><span style="color: #008080;">36</span> <span style="color: #000000;">            }
</span><span style="color: #008080;">37</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">38</span> 
<span style="color: #008080;">39</span>         <span style="color: #008000;">//</span><span style="color: #008000;">drawImage(image,sx,sy,sw,sh,dx,dy,dw,dh)</span>
<span style="color: #008080;">40</span>         <span style="color: #0000ff;">function</span><span style="color: #000000;"> draw13(id){
</span><span style="color: #008080;">41</span>             <span style="color: #0000ff;">var</span> image = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Image();
</span><span style="color: #008080;">42</span>             image.src = "Image/html5.jpg"<span style="color: #000000;">;
</span><span style="color: #008080;">43</span>             <span style="color: #0000ff;">var</span> canvas =<span style="color: #000000;"> document.getElementById(id);
</span><span style="color: #008080;">44</span>            
<span style="color: #008080;">45</span>             <span style="color: #0000ff;">if</span> (canvas == <span style="color: #0000ff;">null</span><span style="color: #000000;">)
</span><span style="color: #008080;">46</span>                 <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">false</span><span style="color: #000000;">;
</span><span style="color: #008080;">47</span>             <span style="color: #0000ff;">var</span> context = canvas.getContext("2d"<span style="color: #000000;">);
</span><span style="color: #008080;">48</span>             context.fillStyle = "#EEEEFF"<span style="color: #000000;">;
</span><span style="color: #008080;">49</span>           
<span style="color: #008080;">50</span>             context.fillRect(0, 0, 400, 300<span style="color: #000000;">);
</span><span style="color: #008080;">51</span>             image.onload = <span style="color: #0000ff;">function</span><span style="color: #000000;"> () {
</span><span style="color: #008080;">52</span>                 context.drawImage(image, 100, 100, 200, 150,50,50,300,200);<span style="color: #008000;">//</span><span style="color: #008000;">这里取的是实际尺寸</span>
<span style="color: #008080;">53</span> <span style="color: #000000;">            }
</span><span style="color: #008080;">54</span>         }</pre>
</div>
</div>
<p>三个方法的运行结果如下：</p>
<div class="arc_pic"><img src="../../images/bw3/2012080410383846.png" alt="" /></div>
<div class="arc_pic"><img src="../../images/bw3/2012080410385174.png" alt="" /></div>
<div class="arc_pic"><img src="../../images/bw3/2012080410390470.png" alt="" /></div>
<p><strong>图像平铺&nbsp;<strong>context.createPattern(image,type)</strong></strong></p>
<p><strong>&nbsp;&nbsp;</strong>&nbsp; type:<strong><br /></strong><em>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; no-repeat:不平铺</em></p>
<p><em>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; repeat-x:横方向平铺</em></p>
<p><em>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; repeat-y:纵方向平铺</em></p>
<p><em>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; repeat:全方向平铺</em></p>
<p>类似图形组合，给出动态的切换平铺类型代码</p>
<div><b>View Code </b>
<div>
<pre><span style="color: #008080;"> 1</span>         <span style="color: #0000ff;">function</span><span style="color: #000000;"> draw14(id) {
</span><span style="color: #008080;"> 2</span>             <span style="color: #008000;">//</span><span style="color: #008000;">传统的平铺是用for循环来处理的，现在直接调用接口</span>
<span style="color: #008080;"> 3</span>             <span style="color: #0000ff;">var</span> image = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Image();
</span><span style="color: #008080;"> 4</span>             <span style="color: #0000ff;">var</span> canvas =<span style="color: #000000;"> document.getElementById(id);
</span><span style="color: #008080;"> 5</span>             <span style="color: #0000ff;">if</span> (canvas == <span style="color: #0000ff;">null</span><span style="color: #000000;">)
</span><span style="color: #008080;"> 6</span>                 <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">false</span><span style="color: #000000;">;
</span><span style="color: #008080;"> 7</span>             <span style="color: #0000ff;">var</span> context = canvas.getContext("2d"<span style="color: #000000;">);
</span><span style="color: #008080;"> 8</span>             <span style="color: #0000ff;">var</span> type = ["no-repeat", "repeat-x", "repeat-y", "repeat"<span style="color: #000000;">];
</span><span style="color: #008080;"> 9</span>             <span style="color: #0000ff;">var</span> i = 0<span style="color: #000000;">;
</span><span style="color: #008080;">10</span>             image.src = "Image/wordslogo.jpg"<span style="color: #000000;">;
</span><span style="color: #008080;">11</span>             image.onload = <span style="color: #0000ff;">function</span><span style="color: #000000;"> () {
</span><span style="color: #008080;">12</span>                 <span style="color: #0000ff;">var</span> interval = setInterval(<span style="color: #0000ff;">function</span><span style="color: #000000;"> () {
</span><span style="color: #008080;">13</span>                     <span style="color: #008000;">//</span><span style="color: #008000;">每次转换平铺类型清空</span>
<span style="color: #008080;">14</span>                     context.clearRect(0, 0, 400, 300<span style="color: #000000;">);
</span><span style="color: #008080;">15</span>                     <span style="color: #0000ff;">if</span> (i &gt;= 4<span style="color: #000000;">) {
</span><span style="color: #008080;">16</span>                         i = 0<span style="color: #000000;">;
</span><span style="color: #008080;">17</span> <span style="color: #000000;">                    }
</span><span style="color: #008080;">18</span>                     <span style="color: #0000ff;">var</span> ptrn =<span style="color: #000000;"> context.createPattern(image, type[i]);
</span><span style="color: #008080;">19</span>                     context.fillStyle =<span style="color: #000000;"> ptrn;
</span><span style="color: #008080;">20</span>                     context.fillRect(0, 0, 400, 300<span style="color: #000000;">);
</span><span style="color: #008080;">21</span>                     i++<span style="color: #000000;">;
</span><span style="color: #008080;">22</span>                 }, 1000<span style="color: #000000;">);
</span><span style="color: #008080;">23</span> <span style="color: #000000;">            };
</span><span style="color: #008080;">24</span>         }</pre>
</div>
</div>
<div class="arc_pic"><img src="../../images/bw3/2012080411125986.png" alt="" /></div>
<p>&nbsp;</p>
<p><strong>图像裁剪：context.clip()</strong></p>
<p>&nbsp;&nbsp;&nbsp; context.clip()只绘制封闭路径区域内的图像，不绘制路径外部图像，用的时候</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 先创建裁剪区域</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 再绘制图像（之后绘制的图形都会采用这个裁剪区域，要取消这个裁剪区域就需要用到保存恢复状态，下面有讲）</p>
<p>&nbsp;给出圆形和星形的裁剪代码</p>
<div><b>View Code </b>
<div>
<pre><span style="color: #008080;"> 1</span>         <span style="color: #008000;">//</span><span style="color: #008000;">图像裁剪</span>
<span style="color: #008080;"> 2</span>         <span style="color: #0000ff;">function</span><span style="color: #000000;"> draw15(id) {
</span><span style="color: #008080;"> 3</span>             <span style="color: #0000ff;">var</span> canvas =<span style="color: #000000;"> document.getElementById(id);
</span><span style="color: #008080;"> 4</span>             <span style="color: #0000ff;">if</span> (canvas == <span style="color: #0000ff;">null</span><span style="color: #000000;">)
</span><span style="color: #008080;"> 5</span>                 <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">false</span><span style="color: #000000;">;
</span><span style="color: #008080;"> 6</span>             <span style="color: #0000ff;">var</span> context = canvas.getContext("2d"<span style="color: #000000;">);
</span><span style="color: #008080;"> 7</span>             context.fillStyle = "black"<span style="color: #000000;">;
</span><span style="color: #008080;"> 8</span>             context.fillRect(0, 0, 400, 300<span style="color: #000000;">);
</span><span style="color: #008080;"> 9</span>             image = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Image();
</span><span style="color: #008080;">10</span>             image.onload = <span style="color: #0000ff;">function</span><span style="color: #000000;"> () {
</span><span style="color: #008080;">11</span> <span style="color: #000000;">                drawImg(context,image);
</span><span style="color: #008080;">12</span> <span style="color: #000000;">            }
</span><span style="color: #008080;">13</span>             image.src = "Image/html5.jpg"
<span style="color: #008080;">14</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">15</span> 
<span style="color: #008080;">16</span>         <span style="color: #0000ff;">function</span><span style="color: #000000;"> drawImg(context, image) {
</span><span style="color: #008080;">17</span>             <span style="color: #008000;">//</span><span style="color: #008000;">圆形裁剪区</span>
<span style="color: #008080;">18</span>             <span style="color: #008000;">//</span><span style="color: #008000;">createCircleClip(context)</span>
<span style="color: #008080;">19</span>             <span style="color: #008000;">//</span><span style="color: #008000;">星形裁剪区</span>
<span style="color: #008080;">20</span> <span style="color: #000000;">            create5StarClip(context);
</span><span style="color: #008080;">21</span>             context.drawImage(image,0,0<span style="color: #000000;">);
</span><span style="color: #008080;">22</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">23</span> 
<span style="color: #008080;">24</span>         <span style="color: #0000ff;">function</span><span style="color: #000000;"> createCircleClip(context) {
</span><span style="color: #008080;">25</span> <span style="color: #000000;">            context.beginPath();
</span><span style="color: #008080;">26</span>             context.arc(200, 150, 100, 0, Math.PI * 2, <span style="color: #0000ff;">true</span><span style="color: #000000;">);
</span><span style="color: #008080;">27</span> <span style="color: #000000;">            context.closePath();
</span><span style="color: #008080;">28</span> <span style="color: #000000;">            context.clip();
</span><span style="color: #008080;">29</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">30</span> 
<span style="color: #008080;">31</span>         <span style="color: #0000ff;">function</span><span style="color: #000000;"> create5StarClip(context) {
</span><span style="color: #008080;">32</span>             <span style="color: #0000ff;">var</span> n = 0<span style="color: #000000;">;
</span><span style="color: #008080;">33</span>             <span style="color: #0000ff;">var</span> dx = 200<span style="color: #000000;">;
</span><span style="color: #008080;">34</span>             <span style="color: #0000ff;">var</span> dy = 135<span style="color: #000000;">;
</span><span style="color: #008080;">35</span>             <span style="color: #0000ff;">var</span> s = 150<span style="color: #000000;">;
</span><span style="color: #008080;">36</span> <span style="color: #000000;">            context.beginPath();
</span><span style="color: #008080;">37</span>             <span style="color: #0000ff;">var</span> x = Math.sin(0<span style="color: #000000;">);
</span><span style="color: #008080;">38</span>             <span style="color: #0000ff;">var</span> y = Math.cos(0<span style="color: #000000;">);
</span><span style="color: #008080;">39</span>             <span style="color: #0000ff;">var</span> dig = Math.PI / 5 * 4<span style="color: #000000;">;
</span><span style="color: #008080;">40</span>             <span style="color: #0000ff;">for</span> (<span style="color: #0000ff;">var</span> i = 0; i &lt; 5; i++<span style="color: #000000;">) {
</span><span style="color: #008080;">41</span>                 <span style="color: #0000ff;">var</span> x = Math.sin(i *<span style="color: #000000;"> dig);
</span><span style="color: #008080;">42</span>                 <span style="color: #0000ff;">var</span> y = Math.cos(i *<span style="color: #000000;"> dig);
</span><span style="color: #008080;">43</span>                 context.lineTo(dx + x * s, dy + y *<span style="color: #000000;"> s);
</span><span style="color: #008080;">44</span> <span style="color: #000000;">            }
</span><span style="color: #008080;">45</span> <span style="color: #000000;">            context.closePath();
</span><span style="color: #008080;">46</span> <span style="color: #000000;">            context.clip();
</span><span style="color: #008080;">47</span>         }</pre>
</div>
</div>
<div class="arc_pic"><img src="../../images/bw3/2012080411372548.png" alt="" /></div>
<div class="arc_pic"><img src="../../images/bw3/2012080411374673.png" alt="" /></div>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><strong><strong>像素处理：</strong></strong></p>
<p><strong><strong>获取像素颜色数组： var</strong> imagedata=context.getImageData(sx,sy,sw,sh)</strong></p>
<p><em>&nbsp;&nbsp;&nbsp; sx:cavas的x轴坐标点</em></p>
<p><em>&nbsp;&nbsp;&nbsp; sy:canvas的y轴坐标点</em></p>
<p><em>&nbsp;&nbsp;&nbsp; sw:距离x的宽度</em></p>
<p><em>&nbsp; &nbsp; sh:距离y的高度</em></p>
<p>可以利用context.getImageData返回的一个像素颜色数组，顺序是所取像素范围的从左到右，从上到下，数组的元素是（所有图形，包括图片，和绘制的图形）每个像素的rgba<strong><br /></strong></p>
<p>[r1,g1,b1,a1,r2,g2,b2,a2...]</p>
<p>&nbsp;</p>
<p><strong>设置像素颜色：context.putImageData(imagedata,dx,dy,dirtyX,dirtyY,dirtyWidth,dirtyHeight)</strong><strong> <br /></strong>&nbsp;&nbsp;&nbsp; 对imagedata数组中的各个像素的r、g、b、a值进行修改，再调用putImageData方法进行绘制</p>
<p><em>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; imagedata:修改后的imagedata</em></p>
<p><em>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dx:重绘图像的起点横坐标（重绘的起点和原来的图像一致的话就会把原来的图形覆盖掉，看起来就像是原来的图像变成现在的图像一样）</em></p>
<p><em>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dy:重绘图像的起点纵坐标</em></p>
<p><em>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //以下可选参数，设置重绘的矩形范围，如果缺省，默认会重绘所有的imegedata</em></p>
<p><em>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dirtyX:矩形左上角x轴坐标</em></p>
<p><em>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dirtyY:矩形左上角y轴坐标</em></p>
<p><em>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dirtyWidth:矩形长度</em></p>
<p><em>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dirtyHeight:矩形高度</em></p>
<p>&nbsp;</p>
<div><b>View Code </b>
<div>
<pre><span style="color: #008080;"> 1</span>         <span style="color: #0000ff;">function</span><span style="color: #000000;"> draw16(id) {
</span><span style="color: #008080;"> 2</span>             <span style="color: #0000ff;">var</span> canvas =<span style="color: #000000;"> document.getElementById(id);
</span><span style="color: #008080;"> 3</span>             <span style="color: #0000ff;">if</span> (canvas == <span style="color: #0000ff;">null</span><span style="color: #000000;">)
</span><span style="color: #008080;"> 4</span>                 <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">false</span><span style="color: #000000;">;
</span><span style="color: #008080;"> 5</span>             <span style="color: #0000ff;">var</span> context = canvas.getContext("2d"<span style="color: #000000;">);
</span><span style="color: #008080;"> 6</span>             context.fillStyle = 'red'
<span style="color: #008080;"> 7</span>             <span style="color: #008000;">//</span><span style="color: #008000;">在右下角画一个正方形</span>
<span style="color: #008080;"> 8</span>             context.fillRect(250,250,150,50<span style="color: #000000;">);
</span><span style="color: #008080;"> 9</span>             <span style="color: #0000ff;">var</span> image = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Image();
</span><span style="color: #008080;">10</span>             image.src = "Image/html5.jpg"<span style="color: #000000;">;
</span><span style="color: #008080;">11</span> 
<span style="color: #008080;">12</span>             image.onload = <span style="color: #0000ff;">function</span><span style="color: #000000;"> () {
</span><span style="color: #008080;">13</span>                 <span style="color: #008000;">//</span><span style="color: #008000;">在左上角画一幅图片</span>
<span style="color: #008080;">14</span>                 context.drawImage(image, 0, 0,200,200<span style="color: #000000;">);
</span><span style="color: #008080;">15</span> 
<span style="color: #008080;">16</span>                 <span style="color: #008000;">//</span><span style="color: #008000;">实验证明imagedata取的是canvas所在范围画的图形，不止是图片</span>
<span style="color: #008080;">17</span>                 <span style="color: #008000;">//</span><span style="color: #008000;">不会取该区域内是空白的canvas的像素</span>
<span style="color: #008080;">18</span>                 <span style="color: #0000ff;">var</span> imagedata = context.getImageData(0, 0, 400, 300<span style="color: #000000;">);
</span><span style="color: #008080;">19</span> 
<span style="color: #008080;">20</span>                 <span style="color: #008000;">//</span><span style="color: #008000;">修改imagedata</span>
<span style="color: #008080;">21</span>                 <span style="color: #0000ff;">for</span> (<span style="color: #0000ff;">var</span> i = 0, n = imagedata.data.length; i &lt; n; i += 4<span style="color: #000000;">) {
</span><span style="color: #008080;">22</span>           
<span style="color: #008080;">23</span>                     imagedata.data[i + 0] = 255 - imagedata.data[i + 0]; <span style="color: #008000;">//</span><span style="color: #008000;">red;</span>
<span style="color: #008080;">24</span>                     imagedata.data[i + 1] = 255 - imagedata.data[i + 1]; <span style="color: #008000;">//</span><span style="color: #008000;">green</span>
<span style="color: #008080;">25</span>                     imagedata.data[i + 2] = 255 - imagedata.data[i + 2]; <span style="color: #008000;">//</span><span style="color: #008000;">blue</span>
<span style="color: #008080;">26</span>                     <span style="color: #008000;">//</span><span style="color: #008000;">imagedata.data[i + 3] = 255 - imagedata.data[i + 3]; //a</span>
<span style="color: #008080;">27</span> <span style="color: #000000;">                }
</span><span style="color: #008080;">28</span>                 context.putImageData(imagedata, 0, 0<span style="color: #000000;">);
</span><span style="color: #008080;">29</span> <span style="color: #000000;">            }
</span><span style="color: #008080;">30</span>         }</pre>
</div>
</div>
<div class="arc_pic"><img src="../../images/bw3/2012080414062011.png" alt="" /></div>

<p>&nbsp;</p>
<p id="14"><strong>绘制文字 </strong></p>
<p><strong>填充文字：context.fillText(text,x,y)&nbsp;&nbsp; </strong></p>
<p><strong>绘制文字轮廓 context.strokeText(text,x,y)<br /></strong></p>
<hr />
<p><em>&nbsp;&nbsp;&nbsp;&nbsp; text:要绘制的文字</em></p>
<p><em>&nbsp;&nbsp;&nbsp;&nbsp; x:文字起点的x坐标轴</em></p>
<p><em>&nbsp;&nbsp;&nbsp;&nbsp; y:文字起点的y坐标轴</em></p>
<p><em>&nbsp;&nbsp;&nbsp;&nbsp; context.font:设置字体样式</em></p>
<p><em>&nbsp;&nbsp;&nbsp;&nbsp; context.textAlign:水平对齐方式</em></p>
<p><em>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; start、end、right、center</em></p>
<p><em>&nbsp;&nbsp;&nbsp;&nbsp; context.textBaseline:垂直对齐方式</em></p>
<p><em>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; top、hanging、middle、alphabetic、ideographic、bottom</em></p>
<p><em>&nbsp;&nbsp;&nbsp;&nbsp; var length=context.measureText(text):计算字体长度(px)那么能不能计算高度啊，很遗憾，不能</em></p>
<div><b>View Code </b>
<div>
<pre><span style="color: #008080;"> 1</span>         <span style="color: #0000ff;">function</span><span style="color: #000000;"> draw17(id) {
</span><span style="color: #008080;"> 2</span>             <span style="color: #0000ff;">var</span> canvas =<span style="color: #000000;"> document.getElementById(id);
</span><span style="color: #008080;"> 3</span>             <span style="color: #0000ff;">if</span> (canvas == <span style="color: #0000ff;">null</span><span style="color: #000000;">)
</span><span style="color: #008080;"> 4</span>                 <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">false</span><span style="color: #000000;">;
</span><span style="color: #008080;"> 5</span>             <span style="color: #0000ff;">var</span> context = canvas.getContext("2d"<span style="color: #000000;">);
</span><span style="color: #008080;"> 6</span>             context.fillStyle = "#EEEEFF"<span style="color: #000000;">;
</span><span style="color: #008080;"> 7</span>             context.fillRect(0,0,400,300<span style="color: #000000;">);
</span><span style="color: #008080;"> 8</span>             context.fillStyle = "#00f"<span style="color: #000000;">;
</span><span style="color: #008080;"> 9</span>             context.font = "italic 30px sans-serif"<span style="color: #000000;">;
</span><span style="color: #008080;">10</span>             context.textBaseline = 'top'<span style="color: #000000;">;
</span><span style="color: #008080;">11</span>             <span style="color: #008000;">//</span><span style="color: #008000;">填充字符串</span>
<span style="color: #008080;">12</span>             <span style="color: #0000ff;">var</span> txt="fill示例文字"
<span style="color: #008080;">13</span>             context.fillText(txt, 0, 0<span style="color: #000000;">);
</span><span style="color: #008080;">14</span>             <span style="color: #0000ff;">var</span> length=<span style="color: #000000;">context.measureText(txt);
</span><span style="color: #008080;">15</span>             context.fillText("长" + length.width + "px", 0, 50<span style="color: #000000;">);
</span><span style="color: #008080;">16</span>             context.font = "bolid 30px sans-serif"<span style="color: #000000;">;
</span><span style="color: #008080;">17</span>             txt = "stroke示例文字"<span style="color: #000000;">;
</span><span style="color: #008080;">18</span>             length =<span style="color: #000000;"> context.measureText(txt);
</span><span style="color: #008080;">19</span>             context.strokeText(txt,0,100<span style="color: #000000;">);
</span><span style="color: #008080;">20</span>             context.fillText("长" + length.width + "px", 0, 150<span style="color: #000000;">);
</span><span style="color: #008080;">21</span>         }</pre>
</div>
</div>
<div class="arc_pic"><img src="../../images/bw3/2012080414453089.png" alt="" /></div>

<p>&nbsp;</p>
<p id="15"><strong>保存和恢复状态 <br /></strong></p>
<p><strong>保存：context.save()<br /></strong></p>
<p><strong>恢复：context.restore()<br /></strong></p>
<hr />
<p>&nbsp;&nbsp;&nbsp; 在上面的裁剪图片提过，一旦设定了裁剪区域，后来绘制的图形都只显示裁剪区域内的内容，要&ldquo;取消&rdquo;这个裁剪区域才能正常绘制其他图形，其实这个&ldquo;取消&rdquo;是利用save（）方法和restore（）方法来实现的。<strong><br /></strong></p>
<p><em>&nbsp;&nbsp;&nbsp; context.save()：调用该方法，会保存当前context的状态、属性（把他理解成游戏存档）</em></p>
<p><em>&nbsp;&nbsp;&nbsp; context.restore():调用该方法就能恢复到save时候context的状态、属性（游戏回档）</em></p>
<div><b>View Code </b>
<div>
<pre><span style="color: #008080;"> 1</span>    <span style="color: #0000ff;">function</span><span style="color: #000000;"> draw18(id) {
</span><span style="color: #008080;"> 2</span>             <span style="color: #0000ff;">var</span> canvas =<span style="color: #000000;"> document.getElementById(id);
</span><span style="color: #008080;"> 3</span>             <span style="color: #0000ff;">if</span> (canvas == <span style="color: #0000ff;">null</span><span style="color: #000000;">)
</span><span style="color: #008080;"> 4</span>                 <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">false</span><span style="color: #000000;">;
</span><span style="color: #008080;"> 5</span>             <span style="color: #0000ff;">var</span> context = canvas.getContext("2d"<span style="color: #000000;">);
</span><span style="color: #008080;"> 6</span>             context.fillStyle = "red"<span style="color: #000000;">;
</span><span style="color: #008080;"> 7</span>             context.save(); <span style="color: #008000;">//</span><span style="color: #008000;">保存了当前context的状态</span>
<span style="color: #008080;"> 8</span>             context.fillStyle = "black"<span style="color: #000000;">;
</span><span style="color: #008080;"> 9</span>             context.fillRect(0, 0, 100, 100<span style="color: #000000;">);
</span><span style="color: #008080;">10</span>             context.restore();<span style="color: #008000;">//</span><span style="color: #008000;">恢复到刚刚保存的状态</span>
<span style="color: #008080;">11</span>             context.fillRect(0,120,100,100<span style="color: #000000;">);
</span><span style="color: #008080;">12</span>         }</pre>
</div>
</div>
<div class="arc_pic"><img src="../../images/bw3/2012080415043389.png" alt="" /></div>
<p>&nbsp;</p>
<p id="16"><strong>保存文件&nbsp; canvas.toDataURL(MIME)<br /></strong></p>
<hr />
<p><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </strong>在canvas中绘出的图片只是canvas标签而已，并非是真正的图片，是不能右键，另存为的，我们可以利用canvas.toDataURL()这个方法把canvas绘制的图形生成一幅图片，生成图片后，就能对图片进行相应的操作了。<strong><br /></strong></p>
<div ><b>View Code </b>
<div>
<pre><span style="color: #008080;"> 1</span>         <span style="color: #0000ff;">function</span><span style="color: #000000;"> draw19(id) {
</span><span style="color: #008080;"> 2</span>             <span style="color: #0000ff;">var</span> canvas =<span style="color: #000000;"> document.getElementById(id);
</span><span style="color: #008080;"> 3</span>             <span style="color: #0000ff;">if</span> (canvas == <span style="color: #0000ff;">null</span><span style="color: #000000;">)
</span><span style="color: #008080;"> 4</span>                 <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">false</span><span style="color: #000000;">;
</span><span style="color: #008080;"> 5</span>             <span style="color: #0000ff;">var</span> context = canvas.getContext("2d"<span style="color: #000000;">);
</span><span style="color: #008080;"> 6</span>             context.fillStyle = "rgb(0,0,225)"<span style="color: #000000;">;
</span><span style="color: #008080;"> 7</span>             context.fillRect(0, 0<span style="color: #000000;">, canvas.width, canvas.height);
</span><span style="color: #008080;"> 8</span>             context.fillStyle = "rgb(255,255,0)"<span style="color: #000000;">;
</span><span style="color: #008080;"> 9</span>             context.fillRect(10, 20, 50, 50<span style="color: #000000;">);
</span><span style="color: #008080;">10</span>             <span style="color: #008000;">//</span><span style="color: #008000;">把图像保存到新的窗口</span>
<span style="color: #008080;">11</span>             <span style="color: #0000ff;">var</span> w=window.open(canvas.toDataURL("image/jpeg"),"smallwin","width=400,height=350"<span style="color: #000000;">);
</span><span style="color: #008080;">12</span>        }</pre>
</div>
</div>
<div class="arc_pic"><img src="../../images/bw3/2012080415272563.png" alt=""/></div>

<p>&nbsp;</p>
<p id="17"><strong>结合setInterval制作动画<br /></strong></p>
<hr />
<p>&nbsp; &nbsp; &nbsp; 基本原理就是定时清除整个canvas重新绘制，下面给出&ldquo;我弹、我弹、我弹弹弹&rdquo;的代码 （额、名字而已）<strong><br /></strong></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 小矩形在矩形区域移动，碰到矩形区域的边缘反弹</p>
<div><b>View Code </b>
<div>
<pre><span style="color: #008080;"> 1</span>        <span style="color: #0000ff;">function</span><span style="color: #000000;"> draw20(id) {
</span><span style="color: #008080;"> 2</span>            <span style="color: #0000ff;">var</span> canvas =<span style="color: #000000;"> document.getElementById(id);
</span><span style="color: #008080;"> 3</span>            <span style="color: #0000ff;">if</span> (canvas == <span style="color: #0000ff;">null</span><span style="color: #000000;">)
</span><span style="color: #008080;"> 4</span>                <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">false</span><span style="color: #000000;">;
</span><span style="color: #008080;"> 5</span>            <span style="color: #0000ff;">var</span> context = canvas.getContext("2d"<span style="color: #000000;">);
</span><span style="color: #008080;"> 6</span>      
<span style="color: #008080;"> 7</span>            <span style="color: #0000ff;">var</span> interal = setInterval(<span style="color: #0000ff;">function</span><span style="color: #000000;"> () {
</span><span style="color: #008080;"> 8</span> <span style="color: #000000;">               move(context);
</span><span style="color: #008080;"> 9</span>            }, 1<span style="color: #000000;">);
</span><span style="color: #008080;">10</span> <span style="color: #000000;">       }
</span><span style="color: #008080;">11</span> 
<span style="color: #008080;">12</span>        <span style="color: #0000ff;">var</span> x = 100;<span style="color: #008000;">//</span><span style="color: #008000;">矩形开始坐标</span>
<span style="color: #008080;">13</span>        <span style="color: #0000ff;">var</span> y = 100;<span style="color: #008000;">//</span><span style="color: #008000;">矩形结束坐标</span>
<span style="color: #008080;">14</span>        <span style="color: #0000ff;">var</span> mx = 0;<span style="color: #008000;">//</span><span style="color: #008000;">0右1左</span>
<span style="color: #008080;">15</span>        <span style="color: #0000ff;">var</span> my = 0; <span style="color: #008000;">//</span><span style="color: #008000;">0下1上</span>
<span style="color: #008080;">16</span>        <span style="color: #0000ff;">var</span> ml = 1;<span style="color: #008000;">//</span><span style="color: #008000;">每次移动长度</span>
<span style="color: #008080;">17</span>        <span style="color: #0000ff;">var</span> w = 20;<span style="color: #008000;">//</span><span style="color: #008000;">矩形宽度</span>
<span style="color: #008080;">18</span>        <span style="color: #0000ff;">var</span> h = 20;<span style="color: #008000;">//</span><span style="color: #008000;">矩形高度</span>
<span style="color: #008080;">19</span>        <span style="color: #0000ff;">var</span> cw = 400;<span style="color: #008000;">//</span><span style="color: #008000;">canvas宽度</span>
<span style="color: #008080;">20</span>        <span style="color: #0000ff;">var</span> ch = 300; <span style="color: #008000;">//</span><span style="color: #008000;">canvas高度</span>
<span style="color: #008080;">21</span> 
<span style="color: #008080;">22</span> 
<span style="color: #008080;">23</span>        <span style="color: #0000ff;">function</span><span style="color: #000000;"> move(context) {
</span><span style="color: #008080;">24</span>            context.clearRect(0, 0, 400, 300<span style="color: #000000;">);
</span><span style="color: #008080;">25</span>            context.fillStyle = "#EEEEFF"<span style="color: #000000;">;
</span><span style="color: #008080;">26</span>            context.fillRect(0, 0, 400, 300<span style="color: #000000;">);
</span><span style="color: #008080;">27</span>            context.fillStyle = "red"<span style="color: #000000;">;
</span><span style="color: #008080;">28</span> <span style="color: #000000;">           context.fillRect(x, y, w, h);       
</span><span style="color: #008080;">29</span>            <span style="color: #0000ff;">if</span> (mx == 0<span style="color: #000000;">) {
</span><span style="color: #008080;">30</span>                x = x +<span style="color: #000000;"> ml;
</span><span style="color: #008080;">31</span>                <span style="color: #0000ff;">if</span> (x &gt;= cw-<span style="color: #000000;">w) {
</span><span style="color: #008080;">32</span>                    mx = 1<span style="color: #000000;">;
</span><span style="color: #008080;">33</span> <span style="color: #000000;">               }
</span><span style="color: #008080;">34</span> <span style="color: #000000;">           }
</span><span style="color: #008080;">35</span>            <span style="color: #0000ff;">else</span><span style="color: #000000;"> {
</span><span style="color: #008080;">36</span>                x = x -<span style="color: #000000;"> ml;
</span><span style="color: #008080;">37</span>                <span style="color: #0000ff;">if</span> (x &lt;= 0<span style="color: #000000;">) {
</span><span style="color: #008080;">38</span>                    mx = 0<span style="color: #000000;">;
</span><span style="color: #008080;">39</span> <span style="color: #000000;">               }
</span><span style="color: #008080;">40</span> <span style="color: #000000;">           }
</span><span style="color: #008080;">41</span>            <span style="color: #0000ff;">if</span> (my == 0<span style="color: #000000;">) {
</span><span style="color: #008080;">42</span>                y = y +<span style="color: #000000;"> ml;
</span><span style="color: #008080;">43</span>                <span style="color: #0000ff;">if</span> (y &gt;= ch-<span style="color: #000000;">h) {
</span><span style="color: #008080;">44</span>                    my = 1<span style="color: #000000;">;
</span><span style="color: #008080;">45</span> <span style="color: #000000;">               }
</span><span style="color: #008080;">46</span> <span style="color: #000000;">           }
</span><span style="color: #008080;">47</span>            <span style="color: #0000ff;">else</span><span style="color: #000000;"> {
</span><span style="color: #008080;">48</span>                y = y -<span style="color: #000000;"> ml;
</span><span style="color: #008080;">49</span>                <span style="color: #0000ff;">if</span> (y &lt;= 0<span style="color: #000000;">) {
</span><span style="color: #008080;">50</span>                    my = 0<span style="color: #000000;">;
</span><span style="color: #008080;">51</span> <span style="color: #000000;">               }
</span><span style="color: #008080;">52</span> <span style="color: #000000;">           }
</span><span style="color: #008080;">53</span>          
<span style="color: #008080;">54</span>        }</pre>
</div>
<div class="arc_pic"><img src="../../images/bw3/2012080415101045.png" alt="" /></div>
</div>
     </div>
     <footer>来源：http://www.cnblogs.com/</footer>
    </article>
 </div>
 </div>
     <footer class="footer">
      博客归TanyaYin所有&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 如若转载博文，请写明来源，谢谢！<img src="../../images/162PaN8-3.jpg"/>
    </footer>
    <div id="back-top" class="x_top"><a href="#top"><img src="../../images/top.png"/></a></div>
     <!--bootjs-->
    <script src="http://cdn.bootcss.com/jquery/1.11.1/jquery.min.js"></script>
    <script src="http://cdn.bootcss.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
</html>
